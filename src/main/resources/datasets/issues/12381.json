{
  "url": "https://api.github.com/repos/facebook/react/issues/12381",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12381/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12381/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12381/events",
  "html_url": "https://github.com/facebook/react/issues/12381",
  "id": 305525757,
  "node_id": "MDU6SXNzdWUzMDU1MjU3NTc=",
  "number": 12381,
  "title": "async-safe way of reading this.state?",
  "user": {
    "login": "linkenneth",
    "id": 1477555,
    "node_id": "MDQ6VXNlcjE0Nzc1NTU=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/1477555?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/linkenneth",
    "html_url": "https://github.com/linkenneth",
    "followers_url": "https://api.github.com/users/linkenneth/followers",
    "following_url": "https://api.github.com/users/linkenneth/following{/other_user}",
    "gists_url": "https://api.github.com/users/linkenneth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/linkenneth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/linkenneth/subscriptions",
    "organizations_url": "https://api.github.com/users/linkenneth/orgs",
    "repos_url": "https://api.github.com/users/linkenneth/repos",
    "events_url": "https://api.github.com/users/linkenneth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/linkenneth/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2018-03-15T12:09:02Z",
  "updated_at": "2018-03-20T10:00:31Z",
  "closed_at": "2018-03-20T10:00:31Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nfeature request / question?\r\n\r\nI'm having a problem that I'm sure some people have had, though I feel like it should be much more solvable. Suppose I have a component that receives state updates from many sources. For example,\r\n\r\n```javascript\r\nclass Counter extends React.Component {\r\n  constructor (props) {\r\n    this.state = { number : 0 };\r\n  }\r\n\r\n  onButtonAClicked () {\r\n    this.setState((prevState) => { prevState.number + 1 });\r\n  }\r\n\r\n  onButtonBClicked () {\r\n    this.setState((prevState) => { prevState.number + 2 });\r\n  }\r\n}\r\n```\r\n\r\nNow, somewhere outside of the `render()` method I need to read `this.state`. Since `this.setState` is asynchronous, there is no safe way to read this number if you don't know the sequence of clicks since the last actual update of this.state. One safe way seems to be using an empty `setState` with a callback to do things:\r\n\r\n```javascript\r\nreadAndDoStuff () {\r\n  this.setState({}, () => {\r\n    // actually do things with this.state\r\n  });\r\n}\r\n```\r\n\r\nbut my requirement is that this method that reads this.state must be synchronous. Also, this form seems a bit odd to me if I don't actually intend to set any state. It seems that `this.setState` being asynchronous forcing my own application to have to make all reads of `this.state` to be asynchronous as well.\r\n\r\nI could instead keep track of my own state and entirely ignore `this.state`. This means I keep `this.state2 = { number: 1 };` and replace calls of `this.setState` with `this.state2[number]++; this.forceUpdate();`, but this just solves the problem by bypassing React entirely.\r\n\r\nMy question is: is there a way to force the immediate setting of state to read `this.state`, or what is a recommended solution for something like this?",
  "closed_by": {
    "login": "linkenneth",
    "id": 1477555,
    "node_id": "MDQ6VXNlcjE0Nzc1NTU=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/1477555?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/linkenneth",
    "html_url": "https://github.com/linkenneth",
    "followers_url": "https://api.github.com/users/linkenneth/followers",
    "following_url": "https://api.github.com/users/linkenneth/following{/other_user}",
    "gists_url": "https://api.github.com/users/linkenneth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/linkenneth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/linkenneth/subscriptions",
    "organizations_url": "https://api.github.com/users/linkenneth/orgs",
    "repos_url": "https://api.github.com/users/linkenneth/repos",
    "events_url": "https://api.github.com/users/linkenneth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/linkenneth/received_events",
    "type": "User",
    "site_admin": false
  }
}
