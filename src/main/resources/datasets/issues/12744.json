{
  "url": "https://api.github.com/repos/facebook/react/issues/12744",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12744/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12744/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12744/events",
  "html_url": "https://github.com/facebook/react/issues/12744",
  "id": 320416900,
  "node_id": "MDU6SXNzdWUzMjA0MTY5MDA=",
  "number": 12744,
  "title": "Render children at most once through the use of Singletons",
  "user": {
    "login": "dkrutsko",
    "id": 3094700,
    "node_id": "MDQ6VXNlcjMwOTQ3MDA=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/3094700?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dkrutsko",
    "html_url": "https://github.com/dkrutsko",
    "followers_url": "https://api.github.com/users/dkrutsko/followers",
    "following_url": "https://api.github.com/users/dkrutsko/following{/other_user}",
    "gists_url": "https://api.github.com/users/dkrutsko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dkrutsko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dkrutsko/subscriptions",
    "organizations_url": "https://api.github.com/users/dkrutsko/orgs",
    "repos_url": "https://api.github.com/users/dkrutsko/repos",
    "events_url": "https://api.github.com/users/dkrutsko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dkrutsko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2018-05-04T20:20:33Z",
  "updated_at": "2018-05-05T05:07:13Z",
  "closed_at": "2018-05-05T05:07:13Z",
  "author_association": "NONE",
  "body": "## Proposed Feature\r\n\r\n`React.createSingleton`\r\n\r\nReturns a unique React component which could be used anywhere but its children would only get rendered a single time for every location the returned Singleton is used. Very useful for declaring SVG filters but can be combined with anything else including [Portals](https://reactjs.org/docs/portals.html), [Fragments](https://reactjs.org/docs/fragments.html) and so on.\r\n\r\n## Use Case\r\nWe have a Ripple component similar to [Material-UI](https://www.webcomponents.org/element/PolymerElements/paper-ripple) which could get applied to anything including a `div` and a `button`. Our Ripple effect makes use of an SVG filter for a [gooey effect](https://css-tricks.com/gooey-effect). It's easy for us to bake the SVG into the Ripple component but we only need the SVG rendered once, anywhere in the DOM.\r\n\r\nWe make use of the Singleton component to handle rendering this SVG once and when the component rendering the SVG gets destroyed, the responsibility falls upon the next component in the list, if any.\r\n\r\n## Example\r\n```jsx\r\nconst FilterSingleton = React.createSingleton();\r\n\r\nconst FancyEffect = () =>\r\n{\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<FilterSingleton>\r\n\t\t\t\t<svg className='svg-defs' xmlns='http://www.w3.org/2000/svg'>\r\n\t\t\t\t\t<defs><filter id='can-be-used-anywhere'></filter></defs>\r\n\t\t\t\t</svg>\r\n\t\t\t</FilterSingleton>\r\n\r\n\t\t\t<SomeComponent ... />\r\n\t\t\t<SomeComponent ... />\r\n\t\t\t<SomeComponent ... />\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n// Used all throughout your application but SVG is only rendered at most once on the DOM\r\n<FancyEffect />\r\n<FancyEffect />\r\n<FancyEffect />\r\n```\r\n\r\n## Implementation\r\n```jsx\r\nReact.createSingleton = function()\r\n{\r\n\tconst instances = [ ];\r\n\r\n\treturn class Singleton extends PureComponent\r\n\t{\r\n\t\tconstructor (props) {\r\n\t\t\tsuper (props);\r\n\t\t\tinstances.push (this);\r\n\t\t}\r\n\r\n\t\tcomponentWillUnmount() {\r\n\t\t\tconst index = instances.indexOf (this);\r\n\r\n\t\t\tif (index > -1) {\r\n\t\t\t\tinstances.splice (index, 1);\r\n\t\t\t}\r\n\r\n\t\t\tif (instances[0]) {\r\n\t\t\t\tinstances[0].forceUpdate();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\treturn instances[0] === this ? this.props.children : null;\r\n\t\t}\r\n\t};\r\n};\r\n```",
  "closed_by": {
    "login": "aweary",
    "id": 6886061,
    "node_id": "MDQ6VXNlcjY4ODYwNjE=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6886061?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aweary",
    "html_url": "https://github.com/aweary",
    "followers_url": "https://api.github.com/users/aweary/followers",
    "following_url": "https://api.github.com/users/aweary/following{/other_user}",
    "gists_url": "https://api.github.com/users/aweary/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aweary/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aweary/subscriptions",
    "organizations_url": "https://api.github.com/users/aweary/orgs",
    "repos_url": "https://api.github.com/users/aweary/repos",
    "events_url": "https://api.github.com/users/aweary/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aweary/received_events",
    "type": "User",
    "site_admin": false
  }
}
