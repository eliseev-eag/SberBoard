{
  "url": "https://api.github.com/repos/facebook/react/issues/12063",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12063/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12063/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12063/events",
  "html_url": "https://github.com/facebook/react/pull/12063",
  "id": 290238331,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTY0MTU0ODM5",
  "number": 12063,
  "title": "DOM diff and component stack in SSR hydrate mismatch warnings (#10085)",
  "user": {
    "login": "sompylasar",
    "id": 498274,
    "node_id": "MDQ6VXNlcjQ5ODI3NA==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/498274?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sompylasar",
    "html_url": "https://github.com/sompylasar",
    "followers_url": "https://api.github.com/users/sompylasar/followers",
    "following_url": "https://api.github.com/users/sompylasar/following{/other_user}",
    "gists_url": "https://api.github.com/users/sompylasar/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sompylasar/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sompylasar/subscriptions",
    "organizations_url": "https://api.github.com/users/sompylasar/orgs",
    "repos_url": "https://api.github.com/users/sompylasar/repos",
    "events_url": "https://api.github.com/users/sompylasar/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sompylasar/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 196858374,
      "node_id": "MDU6TGFiZWwxOTY4NTgzNzQ=",
      "url": "https://api.github.com/repos/facebook/react/labels/CLA%20Signed",
      "name": "CLA Signed",
      "color": "e7e7e7",
      "default": false
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 44,
  "created_at": "2018-01-21T01:26:08Z",
  "updated_at": "2018-11-06T02:56:39Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "pull_request": {
    "url": "https://api.github.com/repos/facebook/react/pulls/12063",
    "html_url": "https://github.com/facebook/react/pull/12063",
    "diff_url": "https://github.com/facebook/react/pull/12063.diff",
    "patch_url": "https://github.com/facebook/react/pull/12063.patch"
  },
  "body": "Renders DOM attributes in the tags mentioned in the warnings. Borrows the idea and partially implementation of `getNodeSignature` from @giles-v https://github.com/facebook/react/pull/12115\r\n\r\nRenders DOM diff and component stack showing visually the location where the hydration failed. Example warning with a diff (see [the `fixtures/ssr`](https://github.com/facebook/react/pull/12063/files#diff-5ec2d35d1f0d9ccc2f3a4a53d0615ba4) and [the tests](https://github.com/facebook/react/pull/12063/files#diff-1ee0c467f9deb87ae13e737c58c4ac34) for more warning examples):\r\n```\r\nWarning: Expected server HTML to contain a matching <div> in <div>.\r\n\r\n  <div>\r\n    {'nested'}\r\n    <!-- -->\r\n    {' '}\r\n    <p>children <b>text</b></p>\r\n+   <div>{['children ', …]}</div>\r\n  </div>\r\n\r\n    in div (at SSRMismatchTest.js:280)\r\n    in div (at SSRMismatchTest.js:275)\r\n    in div (at SSRMismatchTest.js:308)\r\n    in SSRMismatchTest (at App.js:14)\r\n    in div (at App.js:11)\r\n    in body (at Chrome.js:17)\r\n    in html (at Chrome.js:9)\r\n    in Chrome (at App.js:10)\r\n    in App (at index.js:8)\r\n```\r\n<img width=\"480\" alt=\"react-fixtures-ssr-example\" src=\"https://user-images.githubusercontent.com/498274/41187398-263b17e8-6b5d-11e8-8eae-57556babafc9.png\">\r\n\r\n\r\nRequires changes to ReactFiberReconciler interface functions that handle hydration errors to distinguish insertion from replacement and show insertion as one added line in the diff; show replacement as one removed, one added line, at correct position among the parentInstance's DOM children:\r\n- add `index` (use `fiber.index`) to point at which child node the insertion or replacement occurs;\r\n- add `isReplaced` to distinguish insertion from replacement.\r\n\r\n<details>\r\n<summary>\r\nThe latest screen recording from <code>fixtures/ssr</code> (7.8MB – click to expand)\r\n</summary>\r\n\r\n![react-fixtures-ssr-10mb](https://user-images.githubusercontent.com/498274/41187303-53d64b02-6b5b-11e8-9730-729dd2817d12.gif)\r\n\r\n</details>\r\n\r\n------\r\n\r\n<details><summary>Previous revisions</summary>\r\n\r\n```\r\nWarning: Expected server HTML to contain a matching <div>{['children ', …]}</div> in <div>nested<!-- --> <p>children <b>text</b></p></div>.\r\n  <div>\r\n    {'nested'}\r\n    {' '}\r\n    <p>children <b>text</b></p>\r\n+   <div>{['children ', …]}</div>\r\n  </div>\r\n    in div (at SSRMismatchTest.js:280)\r\n    in div (at SSRMismatchTest.js:275)\r\n    in div (at SSRMismatchTest.js:308)\r\n    in SSRMismatchTest (at App.js:14)\r\n    in div (at App.js:11)\r\n    in body (at Chrome.js:17)\r\n    in html (at Chrome.js:9)\r\n    in Chrome (at App.js:10)\r\n    in App (at index.js:8)\r\n```\r\n\r\nExtends the proof-of-concept at commit 6c425e7b90cd61f1124c566b26fa2a5d00261b1b\r\n\r\n![react-ssr-warning-diff](https://user-images.githubusercontent.com/498274/36652198-11bb46fe-1a62-11e8-9fa2-a612827d1463.gif)\r\n\r\n------\r\n\r\n* Added textual component stack to the hydrate mismatch warnings\r\n* Added DOM hydrate mismatch test cases to fixtures/ssr\r\n\r\nExample warning:\r\n```\r\nWarning: Expected server HTML to contain a matching <p> in <div>.\r\n    in p (at SSRMismatchTest.js:40)\r\n    in div (at SSRMismatchTest.js:39)\r\n    in div (at SSRMismatchTest.js:46)\r\n    in SSRMismatchTest (at App.js:14)\r\n    in div (at App.js:11)\r\n    in body (at Chrome.js:17)\r\n    in html (at Chrome.js:9)\r\n    in Chrome (at App.js:10)\r\n    in App (at index.js:8)\r\n```\r\n\r\n![react-ssr-mismatch](https://user-images.githubusercontent.com/498274/35189753-a3e6eefc-fe06-11e7-9a15-216bcf4a6e83.gif)\r\n\r\n</details>\r\n\r\n------\r\n\r\nFixes https://github.com/facebook/react/issues/10085",
  "closed_by": null
}
