{
  "url": "https://api.github.com/repos/facebook/react/issues/15422",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/15422/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/15422/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/15422/events",
  "html_url": "https://github.com/facebook/react/issues/15422",
  "id": 433490923,
  "node_id": "MDU6SXNzdWU0MzM0OTA5MjM=",
  "number": 15422,
  "title": "Trying to render react native component using context in jest test environment fails",
  "user": {
    "login": "yaizudamashii",
    "id": 7308157,
    "node_id": "MDQ6VXNlcjczMDgxNTc=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7308157?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yaizudamashii",
    "html_url": "https://github.com/yaizudamashii",
    "followers_url": "https://api.github.com/users/yaizudamashii/followers",
    "following_url": "https://api.github.com/users/yaizudamashii/following{/other_user}",
    "gists_url": "https://api.github.com/users/yaizudamashii/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yaizudamashii/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yaizudamashii/subscriptions",
    "organizations_url": "https://api.github.com/users/yaizudamashii/orgs",
    "repos_url": "https://api.github.com/users/yaizudamashii/repos",
    "events_url": "https://api.github.com/users/yaizudamashii/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yaizudamashii/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-04-15T21:41:56Z",
  "updated_at": "2019-04-15T22:09:52Z",
  "closed_at": "2019-04-15T22:09:52Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\nReport a bug\r\n\r\n**What is the current behavior?**\r\n```\r\nrenderer.create( //Invariant Violation: Element type\r\n            <ThemeContext.Provider>\r\n                <ThemeContext.Provider>\r\n                    {(theme) => <MyText>abc</MyText>}\r\n                </ThemeContext.Provider>\r\n            </ThemeContext.Provider>\r\n        );\r\n```\r\nproduces Invariant Violation\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\n```\r\n// ThemeContext.js\r\nimport React from 'react';\r\n\r\nexport const ThemeContext = React.createContext(\r\n    { color: 'white' }\r\n);\r\n```\r\n\r\n```\r\n// MyText.js\r\nimport React, { PureComponent } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Text } from 'react-native';\r\n\r\nexport class MyText extends PureComponent {\r\n    static propTypes = {\r\n        children: PropTypes.node.isRequired\r\n    };\r\n\r\n    static defaultProps = {};\r\n\r\n    render() {\r\n        let text = this.props.children;\r\n        return (\r\n            <Text>\r\n                {text}\r\n            </Text>\r\n        );\r\n    }\r\n};\r\n```\r\n\r\n```\r\n// MyText.test.js\r\nimport React from 'react';\r\nimport { MyText } from \"../MyText\";\r\nimport { ThemeContext } from '../ThemeContext';\r\n\r\ndescribe('MyText', () => {\r\n\r\n    it('should render component', () => {\r\n        const wrapper = renderer.create(\r\n            <ThemeContext.Provider value={mobileColorThemes.standard}>\r\n                <ThemeContext.Consumer>\r\n                    {(theme) => <MyText>abc</MyText>}\r\n                </ThemeContext.Consumer>\r\n            </ThemeContext.Provider>\r\n        );\r\n        expect(wrapper).toMatchSnapshot();\r\n    });\r\n});\r\n```\r\n\r\nBut when I run the test file with jest,\r\n`jest text/__tests__/MyText.test.js`\r\n\r\nI get the following error\r\n```\r\nInvariant Violation: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object.\r\n\r\n      at invariant (node_modules/fbjs/lib/invariant.js:42:15)\r\n      at createFiberFromElementType (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:1933:5)\r\n      at createFiberFromElement (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:1878:15)\r\n      at reconcileSingleElement (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:3334:19)\r\n      at reconcileChildFibers (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:3433:35)\r\n      at reconcileChildrenAtPriority (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4091:30)\r\n      at reconcileChildren (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4074:5)\r\n      at updateHostRoot (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4268:9)\r\n      at beginWork (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:4563:16)\r\n      at performUnitOfWork (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:6529:16)...\r\n```\r\n\r\n\r\n\r\n**What is the expected behavior?**\r\nThe component is rendered, having provided context and then consuming context\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nUsing jest 24.1.0, react-native 0.56, react-test-renderer 16.0.0, react 16.4.1",
  "closed_by": {
    "login": "yaizudamashii",
    "id": 7308157,
    "node_id": "MDQ6VXNlcjczMDgxNTc=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7308157?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yaizudamashii",
    "html_url": "https://github.com/yaizudamashii",
    "followers_url": "https://api.github.com/users/yaizudamashii/followers",
    "following_url": "https://api.github.com/users/yaizudamashii/following{/other_user}",
    "gists_url": "https://api.github.com/users/yaizudamashii/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yaizudamashii/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yaizudamashii/subscriptions",
    "organizations_url": "https://api.github.com/users/yaizudamashii/orgs",
    "repos_url": "https://api.github.com/users/yaizudamashii/repos",
    "events_url": "https://api.github.com/users/yaizudamashii/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yaizudamashii/received_events",
    "type": "User",
    "site_admin": false
  }
}
