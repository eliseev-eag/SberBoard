{
  "url": "https://api.github.com/repos/facebook/react/issues/10476",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/10476/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/10476/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/10476/events",
  "html_url": "https://github.com/facebook/react/issues/10476",
  "id": 250938530,
  "node_id": "MDU6SXNzdWUyNTA5Mzg1MzA=",
  "number": 10476,
  "title": "Circular reference in \"bound method\"",
  "user": {
    "login": "iamvery",
    "id": 79619,
    "node_id": "MDQ6VXNlcjc5NjE5",
    "avatar_url": "https://avatars2.githubusercontent.com/u/79619?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamvery",
    "html_url": "https://github.com/iamvery",
    "followers_url": "https://api.github.com/users/iamvery/followers",
    "following_url": "https://api.github.com/users/iamvery/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamvery/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamvery/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamvery/subscriptions",
    "organizations_url": "https://api.github.com/users/iamvery/orgs",
    "repos_url": "https://api.github.com/users/iamvery/repos",
    "events_url": "https://api.github.com/users/iamvery/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamvery/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2017-08-17T13:10:36Z",
  "updated_at": "2017-08-22T09:31:17Z",
  "closed_at": "2017-08-17T22:02:38Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\n\r\nUnclear, but I lean towards *bug*.\r\n\r\n**What is the current behavior?**\r\n\r\nCertain \"bound\" functions create a circular reference which makes traversing objects problematic.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem via https://jsfiddle.net or similar (template: https://jsfiddle.net/84v837e9/).**\r\n\r\nI'm not sure how to produce a small test case for this issue. \r\n\r\n**What is the expected behavior?**\r\n\r\nUnsure.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nReact 16.0.0-alpha.12\r\nReact Native 0.46.4\r\nJest 20.0.4\r\n\r\nThis is happening in a test when I attempt to use [jsonpath](https://github.com/dchester/jsonpath/pull/69) to query the results of `renderer.create(<ListItem />).toJSON()`. As you can see from that link, I have attempted to address the circular reference in the jsonpath library, but the problem persists. I have managed to track this down to a circular property defined in `create-react-class` (which is apparently still used by some native components). Here is that snippet of code:\r\n\r\n```\r\nfunction bindAutoBindMethod(component, method) {\r\n  var boundMethod = method.bind(component);\r\n\r\n  boundMethod.__reactBoundContext = component;\r\n  boundMethod.__reactBoundMethod = method;\r\n  boundMethod.__reactBoundArguments = null;\r\n```\r\n\r\nUnfortunately I've yet to narrow that down the precise place this occurs in source as that method definition is repeated in several modules. However I did confirm the issue in this case is isolated to the single file `node_modules/create-create-class/factory.js`.\r\n\r\nThe circular reference in particular is the `component` value in this example. By changing the line from a regular (enumerable) property to one defined with `Object.defineProperty` (non-enumerable), the issue goes away. So for e.g.\r\n\r\n```\r\n\r\nfunction bindAutoBindMethod(component, method) {\r\n  var boundMethod = method.bind(component);\r\n\r\n  Object.define_property(boundMethod, '__reactBoundContext', { value: component });\r\n  boundMethod.__reactBoundMethod = method;\r\n  boundMethod.__reactBoundArguments = null;\r\n```\r\n\r\nThat is because the `component` value contains the circular reference, because all components themselves have a reference to this `__reactBoundContext` value. So this becomes a problem when traversing the object tree based on its keys as the `__reactBoundContext` key is enumerated.\r\n\r\nYou can see my attempt at avoiding circular references [here](https://github.com/dchester/jsonpath/pull/69). However unfortunately it still isn't addressing my issue with this particular property. Perhaps my \"fix\" is naive or otherwise missing a case that I have yet to reproduce in isolation?\r\n\r\nThank you so much for all your hard work and attention to this particularly gritty issue! I must apologize if anything I've said doesn't make clear sense, I am just beginning to get familiar with JS development. ❤️ ",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
