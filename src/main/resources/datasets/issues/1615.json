{
  "url": "https://api.github.com/repos/facebook/react/issues/1615",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/1615/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/1615/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/1615/events",
  "html_url": "https://github.com/facebook/react/issues/1615",
  "id": 34439606,
  "node_id": "MDU6SXNzdWUzNDQzOTYwNg==",
  "number": 1615,
  "title": "addons.update directive precedence order",
  "user": {
    "login": "DalekBaldwin",
    "id": 1544692,
    "node_id": "MDQ6VXNlcjE1NDQ2OTI=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/1544692?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DalekBaldwin",
    "html_url": "https://github.com/DalekBaldwin",
    "followers_url": "https://api.github.com/users/DalekBaldwin/followers",
    "following_url": "https://api.github.com/users/DalekBaldwin/following{/other_user}",
    "gists_url": "https://api.github.com/users/DalekBaldwin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DalekBaldwin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DalekBaldwin/subscriptions",
    "organizations_url": "https://api.github.com/users/DalekBaldwin/orgs",
    "repos_url": "https://api.github.com/users/DalekBaldwin/repos",
    "events_url": "https://api.github.com/users/DalekBaldwin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DalekBaldwin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2014-05-28T06:43:39Z",
  "updated_at": "2016-04-01T02:36:56Z",
  "closed_at": "2016-04-01T02:36:56Z",
  "author_association": "NONE",
  "body": "``` .js\nvar an_array = [0,1,2,3,4,5];\nReact.addons.update(an_array, {4: {$set: '$set'}, $push: ['p','u','s','h'], $unshift: ['u','n','s','h','i','f','t'], $splice: [[1,1,'$splice','slice','dice']]});\n\n// result:\n[\"t\", \"$splice\", \"slice\", \"dice\", \"$set\", \"h\", \"s\", \"n\", \"u\", 0, 1, 2, 3, 4, 5, \"p\", \"u\", \"s\", \"h\"]\n```\n\nIs this a sane ordering for handling these directives? I'd never want to have `update` recurse into something I've already `$push`ed, `$unshift`ed, or `$splice`d in -- otherwise I would have included the changes in those directives' arguments originally. I think the most natural expectation would be that update should recurse into existing elements at their indices in the original array, then splice in the `$splice` directive, then `$push` and `$unshift` new elements to ensure they appear at the ends of the resulting array, like this:\n\n``` .js\n[\"t\", \"f\", \"i\", \"h\", \"s\", \"n\", \"u\", 0, \"$splice\", \"slice\", \"dice\", 2, 3, \"$set\", 5, \"p\", \"u\", \"s\", \"h\"]\n```\n\n As it is now, for certain cases, the programmer would have to introduce difficult-to-visually-inspect index-twiddling logic or split the changes up among multiple calls to `update` to produce the desired result.\n\nThe tests for `update` don't include any cases where multiple directives appear for a single value, so I'm not sure whether this is intentional or whether anybody depends on this behavior. But especially when you're dealing with trees of this form:\n\n``` .js\n{...\n children:\n [{...\n   children:\n   [{...\n     children:\n     [...]\n    }\n    ...]\n  }]}\n```\n\nthe current behavior really doesn't allow for the same visual clarity that makes `update` so helpful for trees composed entirely of objects.\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
