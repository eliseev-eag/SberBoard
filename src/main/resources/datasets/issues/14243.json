{
  "url": "https://api.github.com/repos/facebook/react/issues/14243",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14243/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14243/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14243/events",
  "html_url": "https://github.com/facebook/react/issues/14243",
  "id": 381298861,
  "node_id": "MDU6SXNzdWUzODEyOTg4NjE=",
  "number": 14243,
  "title": "static contextType resolving this.context to null in some cases",
  "user": {
    "login": "milesj",
    "id": 143744,
    "node_id": "MDQ6VXNlcjE0Mzc0NA==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/143744?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/milesj",
    "html_url": "https://github.com/milesj",
    "followers_url": "https://api.github.com/users/milesj/followers",
    "following_url": "https://api.github.com/users/milesj/following{/other_user}",
    "gists_url": "https://api.github.com/users/milesj/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/milesj/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/milesj/subscriptions",
    "organizations_url": "https://api.github.com/users/milesj/orgs",
    "repos_url": "https://api.github.com/users/milesj/repos",
    "events_url": "https://api.github.com/users/milesj/events{/privacy}",
    "received_events_url": "https://api.github.com/users/milesj/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 620368407,
      "node_id": "MDU6TGFiZWw2MjAzNjg0MDc=",
      "url": "https://api.github.com/repos/facebook/react/labels/Resolution:%20Needs%20More%20Information",
      "name": "Resolution: Needs More Information",
      "color": "fffde7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-11-15T19:06:58Z",
  "updated_at": "2019-09-04T10:10:24Z",
  "closed_at": "2019-09-04T10:10:24Z",
  "author_association": "CONTRIBUTOR",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\nBug.\r\n\r\n**What is the current behavior?**\r\n\r\nWe have a toasts system powered by the new React context. To make integration easier on the consumer side, we started using `static contextType` over `Context.Consumer` or an HOC. This works for the most part, but we're seeing errors like the following all over Sentry: \"TypeError: Cannot read property 'addToast' of null\".\r\n\r\nMost of these errors occur within the then/catch of a promise, so I'm leaning towards it being an async/reconciler bug in which `this.context` is being unset to early? Or perhaps the component being unmounted?\r\n\r\nI've audited all the implementations throwing errors, and they all have `static contextType` set correctly, and are properly referencing `this.context`.\r\n\r\nI even tried the following, which also fails.\r\n\r\n```\r\nconst { context } = this;\r\n\r\nsomeAction().then(() => {\r\n  context.addToast('Did something');\r\n});\r\n```\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\nI've implemented a few test cases here, but all of them seem to pass. I'll try and dig a bit more and see what I can find.\r\n\r\nhttps://codesandbox.io/s/m3l8jn6w4j\r\n\r\n**What is the expected behavior?**\r\n\r\n`this.context` is the context value and not null.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nReact 16.6+\r\nAll browsers\r\nDidn't work in previous versions as it's new functionality.\r\n",
  "closed_by": {
    "login": "threepointone",
    "id": 18808,
    "node_id": "MDQ6VXNlcjE4ODA4",
    "avatar_url": "https://avatars2.githubusercontent.com/u/18808?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/threepointone",
    "html_url": "https://github.com/threepointone",
    "followers_url": "https://api.github.com/users/threepointone/followers",
    "following_url": "https://api.github.com/users/threepointone/following{/other_user}",
    "gists_url": "https://api.github.com/users/threepointone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/threepointone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/threepointone/subscriptions",
    "organizations_url": "https://api.github.com/users/threepointone/orgs",
    "repos_url": "https://api.github.com/users/threepointone/repos",
    "events_url": "https://api.github.com/users/threepointone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/threepointone/received_events",
    "type": "User",
    "site_admin": false
  }
}
