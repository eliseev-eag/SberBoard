{
  "url": "https://api.github.com/repos/facebook/react/issues/16885",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16885/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16885/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16885/events",
  "html_url": "https://github.com/facebook/react/issues/16885",
  "id": 498100563,
  "node_id": "MDU6SXNzdWU0OTgxMDA1NjM=",
  "number": 16885,
  "title": "Wrong DOM calculations between renders in Firefox",
  "user": {
    "login": "elrumordelaluz",
    "id": 784056,
    "node_id": "MDQ6VXNlcjc4NDA1Ng==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/784056?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/elrumordelaluz",
    "html_url": "https://github.com/elrumordelaluz",
    "followers_url": "https://api.github.com/users/elrumordelaluz/followers",
    "following_url": "https://api.github.com/users/elrumordelaluz/following{/other_user}",
    "gists_url": "https://api.github.com/users/elrumordelaluz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/elrumordelaluz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/elrumordelaluz/subscriptions",
    "organizations_url": "https://api.github.com/users/elrumordelaluz/orgs",
    "repos_url": "https://api.github.com/users/elrumordelaluz/repos",
    "events_url": "https://api.github.com/users/elrumordelaluz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/elrumordelaluz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-09-25T07:26:47Z",
  "updated_at": "2019-10-01T09:29:47Z",
  "closed_at": "2019-09-25T22:02:36Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\nbug\r\n\r\n**What is the current behavior?**\r\n\r\nUsing `useCallback` through a custom `hook` to measure DOM node offsets, the first render returns wrong values due to yet not applied _styles_, FOUT or related.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\nFollowing [this example on docs](https://reactjs.org/docs/hooks-faq.html#how-can-i-measure-a-dom-node), adapting to return _offset_ instead of _bounding rect_, seems that due to yet not applied _styles_, the first `render` gets different measures that the following ones.\r\n\r\n[Here is a sandbox](https://codesandbox.io/embed/focused-fast-452bc) with a reproduction, where the first render the red `outline`'s width is large as an `h1` default _styles_ (`display:block` and default _font_) and after `hide/show` it, the `outline` match the `h1` styles.\r\n\r\n![react](https://user-images.githubusercontent.com/784056/65577787-cbce3500-df74-11e9-9425-c5c42fee69ca.gif)\r\n\r\nHere is also the question [asked on _StackOverflow_](https://stackoverflow.com/questions/58058965/solve-lifecycle-difference-measuring-dom-nodes-in-react).\r\n\r\n**What is the expected behavior?**\r\n\r\nTo return always the measurement that match the DOM element with styles applied.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nSince I switched to _Firefox_ as my default browser [time ago](https://twitter.com/elrumordelaluz/status/1069885713439752193), thanks to this template _Issue_ question I found the **most interesting part of this bug**: seems to only happen in _Firefox_!\r\n\r\nIn that case, please let me know if the _issue_ is more related on _browser vendor_ and I'll close the issue to migrate in teh correct bug tracker.\r\n\r\nFollowing there is a _screen capture_ comparing the behaviour between _Safari_ (left one), _Chrom_ (right bottom) and _Firefox_ (right top).\r\n\r\n![react](https://user-images.githubusercontent.com/784056/65578609-62e7bc80-df76-11e9-8390-c8d91b6c4c98.gif)\r\n\r\n\r\n\r\n",
  "closed_by": {
    "login": "bvaughn",
    "id": 29597,
    "node_id": "MDQ6VXNlcjI5NTk3",
    "avatar_url": "https://avatars0.githubusercontent.com/u/29597?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bvaughn",
    "html_url": "https://github.com/bvaughn",
    "followers_url": "https://api.github.com/users/bvaughn/followers",
    "following_url": "https://api.github.com/users/bvaughn/following{/other_user}",
    "gists_url": "https://api.github.com/users/bvaughn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bvaughn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bvaughn/subscriptions",
    "organizations_url": "https://api.github.com/users/bvaughn/orgs",
    "repos_url": "https://api.github.com/users/bvaughn/repos",
    "events_url": "https://api.github.com/users/bvaughn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bvaughn/received_events",
    "type": "User",
    "site_admin": false
  }
}
