{
  "url": "https://api.github.com/repos/facebook/react/issues/12153",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12153/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12153/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12153/events",
  "html_url": "https://github.com/facebook/react/issues/12153",
  "id": 294274205,
  "node_id": "MDU6SXNzdWUyOTQyNzQyMDU=",
  "number": 12153,
  "title": "react-test-renderer: Asynchronous rendering guarantees?",
  "user": {
    "login": "ajhyndman",
    "id": 11449340,
    "node_id": "MDQ6VXNlcjExNDQ5MzQw",
    "avatar_url": "https://avatars1.githubusercontent.com/u/11449340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajhyndman",
    "html_url": "https://github.com/ajhyndman",
    "followers_url": "https://api.github.com/users/ajhyndman/followers",
    "following_url": "https://api.github.com/users/ajhyndman/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajhyndman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajhyndman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajhyndman/subscriptions",
    "organizations_url": "https://api.github.com/users/ajhyndman/orgs",
    "repos_url": "https://api.github.com/users/ajhyndman/repos",
    "events_url": "https://api.github.com/users/ajhyndman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajhyndman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 40929155,
      "node_id": "MDU6TGFiZWw0MDkyOTE1NQ==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Question",
      "name": "Type: Question",
      "color": "cc317c",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-02-05T05:00:31Z",
  "updated_at": "2018-02-05T23:36:59Z",
  "closed_at": "2018-02-05T23:36:59Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\nI think this is just a question.\r\n\r\nAs I understand it, React's newer *Fiber* architecture introduces an asynchronous rendering pipeline, which allows for better prioritisation of work.  I'm also aware that in version 16, React is still expected to render synchronously.\r\n\r\nLooking forward though, when using `react-test-renderer` (especially the [ReactTestInstance](https://github.com/facebook/react/blob/master/packages/react-test-renderer/src/ReactTestRenderer.js#L466-L512) helper APIs), what guarantees are safe for a developer to lean on?\r\n\r\nAfter creating a test-renderer instance, is it safe to immediately introspect the instance to look for a child node with a given type?  Does this differ from components with user-space asynchrony?\r\n\r\nFor instance, if I have a class component with a child node that I want to make a test assertion against, is this safe?  If not, is there a safe way to flush pending reconciler changes, or check for pending work?\r\n\r\n```\r\nconst renderer = ReactTestRenderer.create(<MyComponent />);\r\nconst childInstance = renderer.root.findByType(ChildNode).instance;\r\n```\r\n\r\nCurrently I am experiencing intermittent (1 in 50 or so) failures in test assertions that look like this.  The error output looks like:\r\n\r\n```\r\nFAIL path/to/MyComponent/test.jsx (8.116s)\r\n● MyComponent › test assertion against child node instance\r\n\r\nNo instances found with node type: \"ChildNode\"\r\n\r\nat expectOne (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:8161:9)\r\nat ReactTestInstance.findByType (node_modules/react-test-renderer/cjs/react-test-renderer.development.js:8009:12)\r\n...\r\n```\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nI am seeing this failure when running `react@16.0.0` with `react-test-renderer@16.0.0`, in `jest@22.1.4` while running in `node@8.3.0`.",
  "closed_by": {
    "login": "ajhyndman",
    "id": 11449340,
    "node_id": "MDQ6VXNlcjExNDQ5MzQw",
    "avatar_url": "https://avatars1.githubusercontent.com/u/11449340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajhyndman",
    "html_url": "https://github.com/ajhyndman",
    "followers_url": "https://api.github.com/users/ajhyndman/followers",
    "following_url": "https://api.github.com/users/ajhyndman/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajhyndman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajhyndman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajhyndman/subscriptions",
    "organizations_url": "https://api.github.com/users/ajhyndman/orgs",
    "repos_url": "https://api.github.com/users/ajhyndman/repos",
    "events_url": "https://api.github.com/users/ajhyndman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajhyndman/received_events",
    "type": "User",
    "site_admin": false
  }
}
