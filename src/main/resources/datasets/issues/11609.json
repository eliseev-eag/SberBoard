{
  "url": "https://api.github.com/repos/facebook/react/issues/11609",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/11609/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/11609/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/11609/events",
  "html_url": "https://github.com/facebook/react/issues/11609",
  "id": 275730120,
  "node_id": "MDU6SXNzdWUyNzU3MzAxMjA=",
  "number": 11609,
  "title": "Undo operation on text input throws exception in IE9",
  "user": {
    "login": "nhunzaker",
    "id": 590904,
    "node_id": "MDQ6VXNlcjU5MDkwNA==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/590904?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nhunzaker",
    "html_url": "https://github.com/nhunzaker",
    "followers_url": "https://api.github.com/users/nhunzaker/followers",
    "following_url": "https://api.github.com/users/nhunzaker/following{/other_user}",
    "gists_url": "https://api.github.com/users/nhunzaker/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nhunzaker/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nhunzaker/subscriptions",
    "organizations_url": "https://api.github.com/users/nhunzaker/orgs",
    "repos_url": "https://api.github.com/users/nhunzaker/repos",
    "events_url": "https://api.github.com/users/nhunzaker/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nhunzaker/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 69105383,
      "node_id": "MDU6TGFiZWw2OTEwNTM4Mw==",
      "url": "https://api.github.com/repos/facebook/react/labels/Browser:%20IE",
      "name": "Browser: IE",
      "color": "c7def8",
      "default": false
    },
    {
      "id": 127893911,
      "node_id": "MDU6TGFiZWwxMjc4OTM5MTE=",
      "url": "https://api.github.com/repos/facebook/react/labels/Component:%20DOM",
      "name": "Component: DOM",
      "color": "fef2c0",
      "default": false
    },
    {
      "id": 40929151,
      "node_id": "MDU6TGFiZWw0MDkyOTE1MQ==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Bug",
      "name": "Type: Bug",
      "color": "b60205",
      "default": false
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2017-11-21T14:24:38Z",
  "updated_at": "2018-06-02T21:35:39Z",
  "closed_at": null,
  "author_association": "COLLABORATOR",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\n\r\nThis is a bug report. It looks like IE9 is unmounting text nodes when undoing text input operations. If the display value of the input is rendered in another component, it raises an exception because IE9 does not allow changes to `nodeValue` on unmounted text nodes.\r\n\r\nI think that's the issue, anyway. It is documented here:\r\n\r\nhttps://connect.microsoft.com/IE/feedbackdetail/view/944330/invalid-argument-error-when-changing-nodevalue-of-a-text-node-removed-by-setting-innerhtml-on-an-ancestor\r\n\r\n**What is the current behavior?**\r\n\r\n1. Open http://react-dom-test-fixtures.surge.sh/number-inputs in IE9\r\n2. Change the text in the first controlled text input\r\n3. Start debugging in the IE9 developer tools\r\n4. Press ctrl+z to undo your text change\r\n5. IE9 raises an exception when setting the nodeValue of the text label to the right of the input \"invalid arguments\":\r\n\r\n**What is the expected behavior?**\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nThis affects IE9 when using React 16. It is also an issue on master.\r\n\r\n--- \r\n\r\nThe issue springs up in ReactDOM.js:\r\n\r\nhttps://github.com/facebook/react/blob/master/packages/react-dom/src/client/ReactDOM.js#L392-L398\r\n\r\nI think there just needs to be a wrapper around the text node to see if it has a parent before updating. Maybe something like:\r\n\r\n```javascript\r\ncommitTextUpdate(\r\n  textInstance: TextInstance,\r\n  oldText: string,\r\n  newText: string,\r\n): void {\r\n  // IE9 will raise an exception if modifying a detached text node\r\n  // https://connect.microsoft.com/IE/feedbackdetail/view/944330/invalid-argument-error-when-changing-nodevalue-of-a-text-node-removed-by-setting-innerhtml-on-an-ancestor\r\n  if (textInstance.parentNode) {\r\n    textInstance.nodeValue = newText;\r\n  }\r\n}\r\n```\r\n\r\nBut that feels like a band-aid solution. I'm curious what is causing the text node to unmount to begin-with.",
  "closed_by": null
}
