{
  "url": "https://api.github.com/repos/facebook/react/issues/12233",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12233/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12233/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12233/events",
  "html_url": "https://github.com/facebook/react/issues/12233",
  "id": 297543236,
  "node_id": "MDU6SXNzdWUyOTc1NDMyMzY=",
  "number": 12233,
  "title": "Ordering of componentWillMount/Unmount in React 16",
  "user": {
    "login": "liuhelen10",
    "id": 4095479,
    "node_id": "MDQ6VXNlcjQwOTU0Nzk=",
    "avatar_url": "https://avatars0.githubusercontent.com/u/4095479?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/liuhelen10",
    "html_url": "https://github.com/liuhelen10",
    "followers_url": "https://api.github.com/users/liuhelen10/followers",
    "following_url": "https://api.github.com/users/liuhelen10/following{/other_user}",
    "gists_url": "https://api.github.com/users/liuhelen10/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/liuhelen10/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/liuhelen10/subscriptions",
    "organizations_url": "https://api.github.com/users/liuhelen10/orgs",
    "repos_url": "https://api.github.com/users/liuhelen10/repos",
    "events_url": "https://api.github.com/users/liuhelen10/events{/privacy}",
    "received_events_url": "https://api.github.com/users/liuhelen10/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 739761016,
      "node_id": "MDU6TGFiZWw3Mzk3NjEwMTY=",
      "url": "https://api.github.com/repos/facebook/react/labels/Component:%20Reconciler",
      "name": "Component: Reconciler",
      "color": "f9a798",
      "default": false
    },
    {
      "id": 710375792,
      "node_id": "MDU6TGFiZWw3MTAzNzU3OTI=",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Discussion",
      "name": "Type: Discussion",
      "color": "fef2c0",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2018-02-15T18:07:04Z",
  "updated_at": "2019-09-25T16:20:41Z",
  "closed_at": "2018-08-09T00:40:35Z",
  "author_association": "NONE",
  "body": "### Problem\r\nIt seems that the ordering of `componentWillMount` and `componentWillUnmount` is no longer guaranteed in React 16 due to support for async `componentWillUnmount`. \r\n\r\nPreviously, `componentWillUnmount` was always called on old components being removed *before* `componentWillMount` was called on new components.\r\n\r\n### Example\r\nWe have a Form component in which inputs \"register\" themselves with the parent Form in `componentWillMount` and deregister themselves in `componentWillUnmount` (this allows the Form to keep track of global state for all of the inputs). The following scenario will cause the Form to throw an error now that ordering is no longer guaranteed:\r\n\r\n```jsx\r\n{ showTextInput ? <TextInput name=\"a\" /> : <CheckboxInput name=\"a\" /> }\r\n```\r\n\r\nIn this scenario, it's possible that the Form will try to register an input with the same name before the previous input has been unmounted, which is not allowed.\r\n\r\n### Question\r\nWhile I understand the reasoning behind this change, I'm wondering what the suggested solution is if our code previously relied on `componentWillUnmount` firing before `componentWillMount`? \r\n\r\nThe most obvious solution that comes to mind is moving the `registerInput` step from `willMount` into `didMount`. However, this means we'll have to deal with an unnecessary re-render upon mounting the input. Is this still the correct approach?",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
