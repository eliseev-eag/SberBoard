{
  "url": "https://api.github.com/repos/facebook/react/issues/600",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/600/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/600/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/600/events",
  "html_url": "https://github.com/facebook/react/issues/600",
  "id": 23211917,
  "node_id": "MDU6SXNzdWUyMzIxMTkxNw==",
  "number": 600,
  "title": "Avoid deoptimization by not accessing undefined properties and/or initializing null properties",
  "user": {
    "login": "plievone",
    "id": 134936,
    "node_id": "MDQ6VXNlcjEzNDkzNg==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/134936?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/plievone",
    "html_url": "https://github.com/plievone",
    "followers_url": "https://api.github.com/users/plievone/followers",
    "following_url": "https://api.github.com/users/plievone/following{/other_user}",
    "gists_url": "https://api.github.com/users/plievone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/plievone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/plievone/subscriptions",
    "organizations_url": "https://api.github.com/users/plievone/orgs",
    "repos_url": "https://api.github.com/users/plievone/repos",
    "events_url": "https://api.github.com/users/plievone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/plievone/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2013-11-24T20:09:52Z",
  "updated_at": "2014-12-31T01:28:51Z",
  "closed_at": "2014-02-16T22:08:48Z",
  "author_association": "CONTRIBUTOR",
  "body": "For fun I ran these benchmarks (https://github.com/paulshen/react-bench/blob/gh-pages/tests.js) on serverside by using `React.renderComponentToString()`.\n\nFor example, `node --trace_deopt sometestfile.js` shows that `ReactComponent.isValidComponent()` is optimized and deoptimized hundreds of times (depending on benchmark iterations, obviously), due to accessing `object.mountComponentIntoNode`, which is undefined for most leaf nodes of type string or number. So a quick fix for `isValidComponent()` is to check `typeof object === 'object'` first. It also avoids some other cascading deopts elsewhere.\n\nThousands of other undefined accesses can be seen in `v8.log` after running with `node --log_suspect sometestfile.js`. Accessing undefined properties is perhaps the most common deopt reason (among with adding new properties without initialising them as null or something earlier), so perhaps they should be fixed for speed/memory performance (optimized functions use less intermediate variables, so less gc burden I suppose). \n\nFor example `__reactAutoBindMap` is accessed as undefined in `ReactCompositeComponentMixin.mountComponent()`, so it could be either initialized as null somewhere, or one could prevent undefined access by using `if ('__reactAutoBindMap' in this) {` instead of `if (this.__reactAutoBindMap) {`. Similarly for `__keyValidated__` property, that is accessed as undefined in `validateExplicitKey()`.\n\nI haven't really looked at the output of `node --trace_deopt --trace_opt_verbose sometestfile.js`, it could reveal some optimization possibilities too.\n",
  "closed_by": {
    "login": "plievone",
    "id": 134936,
    "node_id": "MDQ6VXNlcjEzNDkzNg==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/134936?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/plievone",
    "html_url": "https://github.com/plievone",
    "followers_url": "https://api.github.com/users/plievone/followers",
    "following_url": "https://api.github.com/users/plievone/following{/other_user}",
    "gists_url": "https://api.github.com/users/plievone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/plievone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/plievone/subscriptions",
    "organizations_url": "https://api.github.com/users/plievone/orgs",
    "repos_url": "https://api.github.com/users/plievone/repos",
    "events_url": "https://api.github.com/users/plievone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/plievone/received_events",
    "type": "User",
    "site_admin": false
  }
}
