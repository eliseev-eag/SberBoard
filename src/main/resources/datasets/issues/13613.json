{
  "url": "https://api.github.com/repos/facebook/react/issues/13613",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/13613/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/13613/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/13613/events",
  "html_url": "https://github.com/facebook/react/pull/13613",
  "id": 358857789,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MjE0NDkxNTE0",
  "number": 13613,
  "title": "Remove event pooling",
  "user": {
    "login": "poeschko",
    "id": 586916,
    "node_id": "MDQ6VXNlcjU4NjkxNg==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/586916?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/poeschko",
    "html_url": "https://github.com/poeschko",
    "followers_url": "https://api.github.com/users/poeschko/followers",
    "following_url": "https://api.github.com/users/poeschko/following{/other_user}",
    "gists_url": "https://api.github.com/users/poeschko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/poeschko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/poeschko/subscriptions",
    "organizations_url": "https://api.github.com/users/poeschko/orgs",
    "repos_url": "https://api.github.com/users/poeschko/repos",
    "events_url": "https://api.github.com/users/poeschko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/poeschko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 196858374,
      "node_id": "MDU6TGFiZWwxOTY4NTgzNzQ=",
      "url": "https://api.github.com/repos/facebook/react/labels/CLA%20Signed",
      "name": "CLA Signed",
      "color": "e7e7e7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2018-09-11T02:00:28Z",
  "updated_at": "2018-10-06T14:10:27Z",
  "closed_at": "2018-10-06T14:10:27Z",
  "author_association": "CONTRIBUTOR",
  "pull_request": {
    "url": "https://api.github.com/repos/facebook/react/pulls/13613",
    "html_url": "https://github.com/facebook/react/pull/13613",
    "diff_url": "https://github.com/facebook/react/pull/13613.diff",
    "patch_url": "https://github.com/facebook/react/pull/13613.patch"
  },
  "body": "I started working on this idea by @philipp-spiess during a joint programming session at the React Vienna meetup. It's my first pull request for React, so please go easy on me. :-)\r\n\r\nThe idea is to get rid of the event object pooling mechanism and instead just create new instances whenever needed. I kept the methods `persist` (issueing a warning for now) and `isPersistent` (just always returning `true` now) on `SyntheticEvent` since at least [persist is documented](https://reactjs.org/docs/events.html#event-pooling). That whole section in the documention would still have to be updated (or removed).\r\n\r\nMain benefits:\r\n* reduced code complexity\r\n* smaller bundle size (`react-dom.production.min.js`: 92.2 KB -> 91.54 KB, gzipped 30.01 KB -> 29.81 KB; that's -0.7%)\r\n\r\nI removed quite a few tests that were mostly concerned with checking the persistence of events, since that's not really needed anymore. Instead, I added a single test that checks the result from `isPersistent` being `true` and that `persist` issues a warning (which would still need to be finalized, if we want it at all).\r\n\r\nThe hope is that modern JS engines are optimizing object creation & release enough so that not maintaining a pool does not make a significant difference. (Longer-term, maybe JS engines could make this even faster than the pool implemented in user land?)\r\n\r\nSo far, I quickly tested the performance using the \"Event Pooling\" fixture in Mac Chrome 69 (moving the mouse around for a few seconds, creating a few hundred events) and did not notice a significant effect, certainly not visually and also not when glancing at Chrome's Performance flamechart (also tried with 6x CPU slowdown); I did not notice significant garbage collection activity either. But these are just some very preliminary observations (in a rather simple scenario), so the performance side would still need to be analyzed much more carefully, also across different operating systems and browsers.\r\n\r\nTo make the quick performance check using the fixture UI a bit more meaningful, I added a checkbox to choose the React production build instead of the development build (which remains the default). Please let me know if this should rather go into a separate PR (or if it's not desired at all).\r\n\r\nThis would take care of #13224 (where the idea of getting rid of object pooling is also mentioned).\r\n\r\nI realize that this is quite a big change, so maybe it should have started as an RFC or so. But even if there's more discussion needed, I guess having the code along with it doesn't hurt. Just let me know and I could continue trying to measure the performance impact more carefully (suggestions welcome). But no hard feelings if this is rejected for whatever reason.\r\n\r\nThanks to @philipp-spiess for the introduction to the React code base and kicking off this idea!",
  "closed_by": {
    "login": "poeschko",
    "id": 586916,
    "node_id": "MDQ6VXNlcjU4NjkxNg==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/586916?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/poeschko",
    "html_url": "https://github.com/poeschko",
    "followers_url": "https://api.github.com/users/poeschko/followers",
    "following_url": "https://api.github.com/users/poeschko/following{/other_user}",
    "gists_url": "https://api.github.com/users/poeschko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/poeschko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/poeschko/subscriptions",
    "organizations_url": "https://api.github.com/users/poeschko/orgs",
    "repos_url": "https://api.github.com/users/poeschko/repos",
    "events_url": "https://api.github.com/users/poeschko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/poeschko/received_events",
    "type": "User",
    "site_admin": false
  }
}
