{
  "url": "https://api.github.com/repos/facebook/react/issues/15706",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/15706/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/15706/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/15706/events",
  "html_url": "https://github.com/facebook/react/issues/15706",
  "id": 447112695,
  "node_id": "MDU6SXNzdWU0NDcxMTI2OTU=",
  "number": 15706,
  "title": "Using hook from dependency throws error Invalid hook call",
  "user": {
    "login": "matteoferigo",
    "id": 4498617,
    "node_id": "MDQ6VXNlcjQ0OTg2MTc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/4498617?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matteoferigo",
    "html_url": "https://github.com/matteoferigo",
    "followers_url": "https://api.github.com/users/matteoferigo/followers",
    "following_url": "https://api.github.com/users/matteoferigo/following{/other_user}",
    "gists_url": "https://api.github.com/users/matteoferigo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matteoferigo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matteoferigo/subscriptions",
    "organizations_url": "https://api.github.com/users/matteoferigo/orgs",
    "repos_url": "https://api.github.com/users/matteoferigo/repos",
    "events_url": "https://api.github.com/users/matteoferigo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matteoferigo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-05-22T12:39:57Z",
  "updated_at": "2019-06-18T08:37:04Z",
  "closed_at": "2019-06-18T08:37:04Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nbug\r\n\r\n**What is the current behavior?**\r\nI have a dependency collecting a list of shared hooks.\r\nWhenever I try to run them, I get an `Invalid hook call` error. If I copy it in the main repo, the hook works as expected.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\nIn hooks repository:\r\n```javascript\r\nimport { useState } from 'react'\r\n\r\nexport function useFoo() {\r\n  const [ foo, setFoo ] = useState()\r\n  return [ foo, setFoo ]\r\n}\r\n```\r\nIn react app:\r\n```javascript\r\nimport { useFoo } from '@matteo/hooks'   // throws Invalid hook call\r\n// import { useFoo } from './hooks'      // in-repo import works\r\n\r\nexport function MyComponent() {\r\n  const [ foo, setFoo ] = useFoo()   // breaks here\r\n\r\n  return <a onClick={setFoo}>{foo}</a>\r\n}\r\n```\r\n\r\n**What is the expected behavior?**\r\nI would define hooks into a separate repository, add the dependency in a react project, and get no error.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nHooks repository:\r\n```json\r\n\"dependencies\": {\r\n    \"babel-polyfill\": \"^6.26.0\",\r\n    \"react\": \"^16.8.6\"\r\n},\r\n```\r\nReact app:\r\n```json\r\n\"dependencies\": {\r\n    \"next\": \"^8.1.0\",\r\n    \"next-transpile-modules\": \"^2.3.1\",\r\n    \"react\": \"^16.8.6\",\r\n    \"react-dom\": \"^16.8.6\",\r\n    \"react-jss\": \"^8.6.1\"\r\n},\r\n```\r\n\r\nMaybe I'm not defining the hooks in the proper way... or maybe having `react` dependency even in my submodule generates a double React.\r\nBTW: Next uses React `v16.8.6`, so React versions are the same in both repositories",
  "closed_by": {
    "login": "matteoferigo",
    "id": 4498617,
    "node_id": "MDQ6VXNlcjQ0OTg2MTc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/4498617?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matteoferigo",
    "html_url": "https://github.com/matteoferigo",
    "followers_url": "https://api.github.com/users/matteoferigo/followers",
    "following_url": "https://api.github.com/users/matteoferigo/following{/other_user}",
    "gists_url": "https://api.github.com/users/matteoferigo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matteoferigo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matteoferigo/subscriptions",
    "organizations_url": "https://api.github.com/users/matteoferigo/orgs",
    "repos_url": "https://api.github.com/users/matteoferigo/repos",
    "events_url": "https://api.github.com/users/matteoferigo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matteoferigo/received_events",
    "type": "User",
    "site_admin": false
  }
}
