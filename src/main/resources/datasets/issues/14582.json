{
  "url": "https://api.github.com/repos/facebook/react/issues/14582",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14582/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14582/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14582/events",
  "html_url": "https://github.com/facebook/react/issues/14582",
  "id": 398600719,
  "node_id": "MDU6SXNzdWUzOTg2MDA3MTk=",
  "number": 14582,
  "title": "[Hooks] Invariant Violation - Using a library that have hooks",
  "user": {
    "login": "aralroca",
    "id": 13313058,
    "node_id": "MDQ6VXNlcjEzMzEzMDU4",
    "avatar_url": "https://avatars3.githubusercontent.com/u/13313058?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aralroca",
    "html_url": "https://github.com/aralroca",
    "followers_url": "https://api.github.com/users/aralroca/followers",
    "following_url": "https://api.github.com/users/aralroca/following{/other_user}",
    "gists_url": "https://api.github.com/users/aralroca/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aralroca/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aralroca/subscriptions",
    "organizations_url": "https://api.github.com/users/aralroca/orgs",
    "repos_url": "https://api.github.com/users/aralroca/repos",
    "events_url": "https://api.github.com/users/aralroca/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aralroca/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-01-12T23:04:55Z",
  "updated_at": "2019-01-13T18:15:56Z",
  "closed_at": "2019-01-13T18:15:56Z",
  "author_association": "NONE",
  "body": "_Versions:_\r\n* **react**: 16.8.0-alpha-0\r\n* **react-dom**: 16.8.0-alpha-0\r\n* **react-form-uncontrolled**: 0.3.1\r\n\r\n### Problem ###\r\n\r\nI wrote a simple Form library with just one hook (react-form-uncontrolled). However, **using this library** is displaying this error:\r\n\r\n> Invariant Violation: Hooks can only be called inside the body of a function component\r\n\r\nCodesandbox: https://codesandbox.io/s/znx2r55lkp\r\n\r\nAlthough the error says that it can only be called inside the body of a function component, is already on the body...\r\n\r\nOriginal library code: \r\n\r\n```js\r\nimport React, { useCallback } from 'react'\r\n\r\nfunction Form(props) {\r\n  const onSubmitForm = useCallback(event => {\r\n    event.preventDefault()\r\n    event.stopPropagation()\r\n\r\n    const { onSubmit = () => {} } = props\r\n    const fields = Array.prototype.slice.call(event.target)\r\n      .filter(field => field.name)\r\n      .reduce((form, { name, value }) => ({\r\n        ...form,\r\n        [name]: typeof value === 'string'\r\n          ? value.trim()\r\n          : value,\r\n      }), {})\r\n\r\n    onSubmit(fields)\r\n  }, [])\r\n  const { children } = props\r\n\r\n  return (\r\n    <form {...props} onSubmit={onSubmitForm}>\r\n      {children}\r\n    </form>\r\n  )\r\n}\r\n\r\nfunction Input(props) {\r\n  const { label, name } = props\r\n\r\n  return (\r\n    <label htmlFor={name}>\r\n      <div>{label}</div>\r\n      <input\r\n        {...props}\r\n        id={name}\r\n        name={name}\r\n      />\r\n    </label>\r\n  )\r\n}\r\n\r\nmodule.exports = {\r\n  Form, Input,\r\n}\r\n```\r\n\r\nAt the beginning I thought that was for the Babel transpilation. Nevertheless, running a codesandbox using the transpiled code instead of the library, is working well:\r\n\r\n* https://codesandbox.io/s/k0j6zn2xzo\r\n\r\nDowngrading these versions in the project that use the library, it works:\r\n\r\n* **react** -> from 16.8.0-alpha.0 -> to 16.7.0-alpha.2\r\n* **react-dom:** from 16.8.0-alpha.0 -> to 16.7.0-alpha.2\r\n\r\nSo looks that for some reason with 16.8.0-alpha.0 is not compatible.\r\n\r\n\r\n> **Note**: Perhaps is not an issue and is something that I'm doing wrong... Any sugestion? ",
  "closed_by": {
    "login": "aralroca",
    "id": 13313058,
    "node_id": "MDQ6VXNlcjEzMzEzMDU4",
    "avatar_url": "https://avatars3.githubusercontent.com/u/13313058?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aralroca",
    "html_url": "https://github.com/aralroca",
    "followers_url": "https://api.github.com/users/aralroca/followers",
    "following_url": "https://api.github.com/users/aralroca/following{/other_user}",
    "gists_url": "https://api.github.com/users/aralroca/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aralroca/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aralroca/subscriptions",
    "organizations_url": "https://api.github.com/users/aralroca/orgs",
    "repos_url": "https://api.github.com/users/aralroca/repos",
    "events_url": "https://api.github.com/users/aralroca/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aralroca/received_events",
    "type": "User",
    "site_admin": false
  }
}
