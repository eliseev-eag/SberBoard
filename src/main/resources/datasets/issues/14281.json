{
  "url": "https://api.github.com/repos/facebook/react/issues/14281",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14281/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14281/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14281/events",
  "html_url": "https://github.com/facebook/react/issues/14281",
  "id": 382429131,
  "node_id": "MDU6SXNzdWUzODI0MjkxMzE=",
  "number": 14281,
  "title": "Client side render mounts server-side rendered div but doesn't recognize the differences.",
  "user": {
    "login": "nuclearspike",
    "id": 1151638,
    "node_id": "MDQ6VXNlcjExNTE2Mzg=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/1151638?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nuclearspike",
    "html_url": "https://github.com/nuclearspike",
    "followers_url": "https://api.github.com/users/nuclearspike/followers",
    "following_url": "https://api.github.com/users/nuclearspike/following{/other_user}",
    "gists_url": "https://api.github.com/users/nuclearspike/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nuclearspike/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nuclearspike/subscriptions",
    "organizations_url": "https://api.github.com/users/nuclearspike/orgs",
    "repos_url": "https://api.github.com/users/nuclearspike/repos",
    "events_url": "https://api.github.com/users/nuclearspike/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nuclearspike/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-11-19T23:03:05Z",
  "updated_at": "2018-11-28T06:20:54Z",
  "closed_at": "2018-11-22T14:46:14Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nBug\r\n\r\n**What is the current behavior?**\r\nWhen client re-renders a server-rendered element, it no longer checks to see if it element is different. NodeJS server render, this had worked in previous versions of react but broke after upgrading to 16 from 15. It does render the children, but the root div being output is treated as though it's the same even though the attributes are very different.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\nI can't do a fiddle or sandbox since it's an SSR/CSR issue.\r\n\r\nconsider:\r\n\r\n```\r\nclass C extends React.Component {\r\n   render() {\r\n       // if SSR, just output a simple div to hold the sizing so that the client can fill it without causing the page to re-adjust.\r\n       if (!process.env.BROWSER) {\r\n          return <div style={{ height: 46 }} />\r\n       }\r\n\r\n      return (\r\n           <div key=\"client\" className={cx(.....)}>\r\n                ... bunch of components that only render client-side. shouldn't matter what they are for this report.\r\n           </div>\r\n      )\r\n   }\r\n}\r\n```\r\n\r\n**What is the expected behavior?**\r\n\r\nPreviously (react v15), it would output the div with style attribute at the server but the client would re-render it, dropping the style and adding the classes which is exactly what I want. But now, it looks like it sees the server-rendered div as being the same as what the client rendered and doesn't add the classes or drop the style. It does recognize that the client has children and those do show up. I can only interpret this as a bug.\r\n\r\noutput from SSR only (no client code) this is expected and consistent between v15 and v16)\r\n```\r\n  <div style=\"height: 46px\" />\r\n````\r\noutput after client does it's own render (not expected).\r\n```\r\n  <div style=\"height: 46px\">\r\n     ...bunch of client-only components.\r\n  </div>\r\n````\r\nWhat it **should have** produced (used to in v 15) after the client side re-rendering of an SSR page\r\n```\r\n  <div key=\"client\" class=\"...bunch of css classes\">\r\n     ...bunch of client-only components.\r\n  </div>\r\n```\r\nFor my uses, by not applying the CSS classes to the root div means that all sorts of styling options were not applied to all of the children due to the CSS rules.\r\n\r\nIt should have had a final output of a div with the CSS classes defined by the client code without any style attributes defined by the server code.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nBroken after I upgraded to v16 from v15\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
