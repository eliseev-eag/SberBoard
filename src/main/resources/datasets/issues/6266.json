{
  "url": "https://api.github.com/repos/facebook/react/issues/6266",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/6266/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/6266/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/6266/events",
  "html_url": "https://github.com/facebook/react/issues/6266",
  "id": 141077833,
  "node_id": "MDU6SXNzdWUxNDEwNzc4MzM=",
  "number": 6266,
  "title": "(node) warning: possible EventEmitter memory leak detected. 11 listeners added",
  "user": {
    "login": "Thibaut-Fatus",
    "id": 7557608,
    "node_id": "MDQ6VXNlcjc1NTc2MDg=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7557608?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Thibaut-Fatus",
    "html_url": "https://github.com/Thibaut-Fatus",
    "followers_url": "https://api.github.com/users/Thibaut-Fatus/followers",
    "following_url": "https://api.github.com/users/Thibaut-Fatus/following{/other_user}",
    "gists_url": "https://api.github.com/users/Thibaut-Fatus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Thibaut-Fatus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Thibaut-Fatus/subscriptions",
    "organizations_url": "https://api.github.com/users/Thibaut-Fatus/orgs",
    "repos_url": "https://api.github.com/users/Thibaut-Fatus/repos",
    "events_url": "https://api.github.com/users/Thibaut-Fatus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Thibaut-Fatus/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2016-03-15T19:38:30Z",
  "updated_at": "2016-03-16T08:45:12Z",
  "closed_at": "2016-03-15T21:45:57Z",
  "author_association": "NONE",
  "body": "Hi\n\nThis is a classic, but I cannot fix it this time, it seems like the removeListener method does not remove the callbacks, here is my store:\n\n``` javascript\nimport EventEmitter from 'events';\n\n\nlet _focusFormId = 0;\nlet _count=0;                                                                  \n\n\nclass FormFocusStoreClass extends EventEmitter {                               \n    emitChange() {                                                             \n        this.emit(\"change\");                                                   \n    }                                                                          \n    addChangeListener(callback) {                                              \n        console.log(\"added \" + _count);                                        \n        _count += 1;                                                           \n        this.on(\"change\", callback);                                           \n    }                                                                          \n    removeChangeListener(callback) {                                           \n        _count -= 1;                                                           \n        console.log(\"removed \" + _count);                                      \n        this.removeListener(\"change\", callback);                               \n    }                                                                          \n    updateFormFocus(action) {                                                  \n        _focusFormId = action.nextFormId;                                      \n        this.emitChange();                                                     \n    }                                                                          \n    getFormFocus() {                                                           \n        return {formId: _focusFormId};                                         \n    }                                                                          \n};  \n```\n\nWhen changing url with react router, forms are removed from the dom, and new forms are added, and the corresponding add / remove change listeners are correctly catched by the store\n\n```\nformFocusStore.jsx:15 added 0 \nformFocusStore.jsx:15 added 1\nformFocusStore.jsx:15 added 2\nformFocusStore.jsx:15 added 3\nformFocusStore.jsx:15 added 4\nformFocusStore.jsx:15 added 5\nformFocusStore.jsx:15 added 6\nregisterStore.jsx:91 submit step\nregisterStore.jsx:41 ok\nformFocusStore.jsx:21 removed 6\nformFocusStore.jsx:21 removed 5\nformFocusStore.jsx:21 removed 4\nformFocusStore.jsx:21 removed 3\nformFocusStore.jsx:21 removed 2\nformFocusStore.jsx:21 removed 1\nformFocusStore.jsx:21 removed 0\nconfigureStore.jsx:149 fetch steps catched \nconfigureStore.jsx:154 fetch forms catched \nformFocusStore.jsx:15 added 0\nformFocusStore.jsx:15 added 1\nformFocusStore.jsx:15 added 2\nformFocusStore.jsx:15 added 3\n```\n\nHowever it seems like those listeners are not removed since I get the message \n\n```\n(node) warning: possible EventEmitter memory leak detected. 11 listeners added\n```\n\nThe corresponding Form component has\n\n``` javascript\nexport class Form extends React.Component {\n\n    componentDidMount() {\n        FormFocusStore.addChangeListener(this._onChange.bind(this));\n    }\n    componentWillUnmount() {\n        FormFocusStore.removeChangeListener(this._onChange);\n    }\n...\n}\n\n```\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
