{
  "url": "https://api.github.com/repos/facebook/react/issues/12920",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12920/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12920/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12920/events",
  "html_url": "https://github.com/facebook/react/pull/12920",
  "id": 327092004,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTkwOTc4NTMw",
  "number": 12920,
  "title": "[scheduler] 5/n Error handling in scheduler",
  "user": {
    "login": "flarnie",
    "id": 1114467,
    "node_id": "MDQ6VXNlcjExMTQ0Njc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/1114467?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/flarnie",
    "html_url": "https://github.com/flarnie",
    "followers_url": "https://api.github.com/users/flarnie/followers",
    "following_url": "https://api.github.com/users/flarnie/following{/other_user}",
    "gists_url": "https://api.github.com/users/flarnie/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/flarnie/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/flarnie/subscriptions",
    "organizations_url": "https://api.github.com/users/flarnie/orgs",
    "repos_url": "https://api.github.com/users/flarnie/repos",
    "events_url": "https://api.github.com/users/flarnie/events{/privacy}",
    "received_events_url": "https://api.github.com/users/flarnie/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 196858374,
      "node_id": "MDU6TGFiZWwxOTY4NTgzNzQ=",
      "url": "https://api.github.com/repos/facebook/react/labels/CLA%20Signed",
      "name": "CLA Signed",
      "color": "e7e7e7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2018-05-28T18:17:59Z",
  "updated_at": "2019-09-12T03:51:11Z",
  "closed_at": "2018-05-30T22:38:49Z",
  "author_association": "CONTRIBUTOR",
  "pull_request": {
    "url": "https://api.github.com/repos/facebook/react/pulls/12920",
    "html_url": "https://github.com/facebook/react/pull/12920",
    "diff_url": "https://github.com/facebook/react/pull/12920.diff",
    "patch_url": "https://github.com/facebook/react/pull/12920.patch"
  },
  "body": "**what is the change?:**\r\nWe set a flag before calling any callback, and then use a 'try/finally'\r\nblock to wrap it. Note that we *do not* catch the error, if one is\r\nthrown. But, we only unset the flag after the callback successfully\r\nfinishes.\r\n\r\nIf we reach the 'finally' block and the flag was not unset, then it\r\nmeans an error was thrown.\r\n\r\nIn that case we start a new postMessage callback, to finish calling any\r\nother pending callbacks if there is time.\r\n\r\n**why make this change?:**\r\nWe need to make sure that an error thrown from one callback doesn't stop\r\nother callbacks from firing, but we also don't want to catch or swallow\r\nthe error because we want engineers to still be able to log and debug\r\nerrors. And we don't want to push errors into the wrong frame or change their timing - this simulates almost exactly how it would work with 'requestAnimationFrame' if the callback throws an error.\r\n\r\n**test plan:**\r\nNew tests added are passing, and we verified that they fail without this\r\nchange.\r\n\r\nIn particular, the fixture shows how errors and callbacks act in a real browser and compares the 'schedule.scheduleWork' method to 'requestAnimationFrame'. In Chrome the results are the same:\r\n\r\n<img width=\"1058\" alt=\"screen shot 2018-05-27 at 7 14 55 am\" src=\"https://user-images.githubusercontent.com/1114467/40625596-5638daa0-6268-11e8-8a5e-c39e295d122a.png\">\r\n\r\n**Edit:** In Firefox they are also the same;\r\n<img width=\"750\" alt=\"screen shot 2018-05-29 at 6 11 32 pm\" src=\"https://user-images.githubusercontent.com/1114467/40693363-d3d61780-636b-11e8-893d-ecb6ba8aebc2.png\">\r\n<img width=\"809\" alt=\"screen shot 2018-05-29 at 6 11 53 pm\" src=\"https://user-images.githubusercontent.com/1114467/40693364-d3fc4be4-636b-11e8-84ea-de2a09e379c6.png\">\r\n\r\nHaven't tested IE/Edge yet but I will, not expecting problems there.",
  "closed_by": {
    "login": "flarnie",
    "id": 1114467,
    "node_id": "MDQ6VXNlcjExMTQ0Njc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/1114467?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/flarnie",
    "html_url": "https://github.com/flarnie",
    "followers_url": "https://api.github.com/users/flarnie/followers",
    "following_url": "https://api.github.com/users/flarnie/following{/other_user}",
    "gists_url": "https://api.github.com/users/flarnie/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/flarnie/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/flarnie/subscriptions",
    "organizations_url": "https://api.github.com/users/flarnie/orgs",
    "repos_url": "https://api.github.com/users/flarnie/repos",
    "events_url": "https://api.github.com/users/flarnie/events{/privacy}",
    "received_events_url": "https://api.github.com/users/flarnie/received_events",
    "type": "User",
    "site_admin": false
  }
}
