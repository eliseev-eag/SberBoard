{
  "url": "https://api.github.com/repos/facebook/react/issues/9809",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/9809/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/9809/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/9809/events",
  "html_url": "https://github.com/facebook/react/issues/9809",
  "id": 232067946,
  "node_id": "MDU6SXNzdWUyMzIwNjc5NDY=",
  "number": 9809,
  "title": "touchstart preventDefault() does not prevent click event.",
  "user": {
    "login": "benwiley4000",
    "id": 13558253,
    "node_id": "MDQ6VXNlcjEzNTU4MjUz",
    "avatar_url": "https://avatars2.githubusercontent.com/u/13558253?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benwiley4000",
    "html_url": "https://github.com/benwiley4000",
    "followers_url": "https://api.github.com/users/benwiley4000/followers",
    "following_url": "https://api.github.com/users/benwiley4000/following{/other_user}",
    "gists_url": "https://api.github.com/users/benwiley4000/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benwiley4000/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benwiley4000/subscriptions",
    "organizations_url": "https://api.github.com/users/benwiley4000/orgs",
    "repos_url": "https://api.github.com/users/benwiley4000/repos",
    "events_url": "https://api.github.com/users/benwiley4000/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benwiley4000/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 127893911,
      "node_id": "MDU6TGFiZWwxMjc4OTM5MTE=",
      "url": "https://api.github.com/repos/facebook/react/labels/Component:%20DOM",
      "name": "Component: DOM",
      "color": "fef2c0",
      "default": false
    },
    {
      "id": 710722093,
      "node_id": "MDU6TGFiZWw3MTA3MjIwOTM=",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Needs%20Investigation",
      "name": "Type: Needs Investigation",
      "color": "fbca04",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 24,
  "created_at": "2017-05-29T17:12:21Z",
  "updated_at": "2019-07-02T11:44:13Z",
  "closed_at": "2018-08-17T20:22:26Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nBug\r\n\r\n**What is the current behavior?**\r\nCalling `e.preventDefault()` on a synthetic `onTouchStart` event fails to [prevent the `click` event](https://w3c.github.io/touch-events/#h-note5). I also tried `e.nativeEvent.preventDefault()`, but this didn't make any difference.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem via https://jsfiddle.net or similar (template: https://jsfiddle.net/84v837e9/).**\r\n\r\nHere's a div which is supposed to handle a hover case but **not** process a click the first time is is tapped via touch (click on desktop is fine). However tapping with touch (on a mobile device or using dev tools touch emulation) will trigger both `touchstart` and `click` immediately.\r\n\r\n[jsfiddle](http://jsfiddle.net/69z2wepo/79757/)\r\n```javascript\r\nconst style = {\r\n  background: 'red',\r\n  width: 100,\r\n  height: 100,\r\n  // to ensure `touchstart` `preventDefault()` is allowed on mobile\r\n  touchAction: 'none'\r\n};\r\n\r\nclass SomeButton extends React.Component {\r\n  constructor (props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      hover: false,\r\n      click: false\r\n    };\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div\r\n        style={style}\r\n        onMouseEnter={() => this.setState({ hover: true })}\r\n        onClick={() => this.setState({ click: true })}\r\n        onTouchStart={e => {\r\n          if (!this.state.hover) {\r\n            e.preventDefault(); // doesn't work!\r\n            this.setState({ hover: true });\r\n          }\r\n        }}\r\n      >\r\n        {this.state.hover && 'hover!'}\r\n        {this.state.click && 'click!'}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n```\r\n\r\nHowever if I move the `touchstart` listener to `componentDidMount` and use the normal DOM API, everything works:\r\n\r\n[jsfiddle](http://jsfiddle.net/69z2wepo/79759/)\r\n```javascript\r\n// ...\r\nclass SomeButton extends React.Component {\r\n  constructor (props) {\r\n    // ...\r\n  }\r\n  \r\n  componentDidMount () {\r\n    this.elem.addEventListener('touchstart', e => {\r\n      if (!this.state.hover) {\r\n        e.preventDefault(); // WORKS!\r\n        this.setState({ hover: true });\r\n      }\r\n    });\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div\r\n        ref={elem => this.elem = elem}\r\n        { /* ... (removed onTouchStart) ... */}\r\n      >\r\n        {/* ... */}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n```\r\n\r\n**What is the expected behavior?**\r\nThe first time a `touchstart` is processed, we only treat it as a hover, and wait to process the `click` event until after the next `touchstart`. If the pointer is a mouse, both events can be processed at once.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nReact 15.5.4. Not sure about previous React versions. Chrome for Android, Chrome for Mac emulating touch, Firefox for Mac emulating touch.\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
