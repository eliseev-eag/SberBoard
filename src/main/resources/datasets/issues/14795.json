{
  "url": "https://api.github.com/repos/facebook/react/issues/14795",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14795/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14795/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14795/events",
  "html_url": "https://github.com/facebook/react/issues/14795",
  "id": 407983015,
  "node_id": "MDU6SXNzdWU0MDc5ODMwMTU=",
  "number": 14795,
  "title": "useAsyncReducer / useAsyncDispatcher",
  "user": {
    "login": "timlind",
    "id": 237741,
    "node_id": "MDQ6VXNlcjIzNzc0MQ==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/237741?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/timlind",
    "html_url": "https://github.com/timlind",
    "followers_url": "https://api.github.com/users/timlind/followers",
    "following_url": "https://api.github.com/users/timlind/following{/other_user}",
    "gists_url": "https://api.github.com/users/timlind/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/timlind/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/timlind/subscriptions",
    "organizations_url": "https://api.github.com/users/timlind/orgs",
    "repos_url": "https://api.github.com/users/timlind/repos",
    "events_url": "https://api.github.com/users/timlind/events{/privacy}",
    "received_events_url": "https://api.github.com/users/timlind/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-02-08T02:33:47Z",
  "updated_at": "2019-02-08T15:13:25Z",
  "closed_at": "2019-02-08T15:10:45Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\n Feature + Bug. Proposal for built in useAsyncReducer / useAsyncDispatcher.\r\n\r\n**What is the current behavior?**\r\n\r\nuseReducer doesn't allow async dispatching predictably.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\nhttps://codesandbox.io/s/yzvv9qko9\r\n\r\nAsync dispatch works first time but doesn't fire on subsequent clicks.\r\n\r\n**What is the expected behavior?**\r\n\r\nCalling dispatch should fire exactly once when called asynchronously.\r\n\r\nThis would be the same as what works well with useState, when a function calls setState asynchronously: \r\n\r\n`function load() {\r\n        restService.getAll(\"api/users\").then(() => setState(users));\r\n}`\r\n\r\nuseAsyncReducer could look as follows, as is likely more performant than binding dispatch on each render: \r\n```\r\nfunction useAsyncReducer(reduce, initialState, init) {\r\n  var [state, dispatch] = useReducer(reducer, initialState, init);\r\n\r\n  function reducer(state, action) {\r\n    return reduce(state, { ...action, dispatch });\r\n  }\r\n\r\n  return [state, dispatch];\r\n}\r\n```\r\n\r\nuseAsyncDispatcher could look as follows:\r\n```\r\nexport function useAsyncDispatcher(reducer, initialState, init) {\r\n    var [state, _dispatch] = useReducer(reducer, initialState, init);\r\n\r\n    function dispatch(action) {\r\n        if (typeof action === 'function') {\r\n            action(dispatch);\r\n        } else {\r\n            _dispatch(action);\r\n        }\r\n    }\r\n\r\n    return [\r\n        state,\r\n        dispatch\r\n    ];\r\n}\r\n```\r\n\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\n16.8.0\r\n<img width=\"557\" alt=\"screen shot 2019-02-08 at 04 32 27\" src=\"https://user-images.githubusercontent.com/237741/52455793-94805480-2b5a-11e9-839e-f2eedfe6aae3.png\">\r\n\r\n",
  "closed_by": {
    "login": "timlind",
    "id": 237741,
    "node_id": "MDQ6VXNlcjIzNzc0MQ==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/237741?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/timlind",
    "html_url": "https://github.com/timlind",
    "followers_url": "https://api.github.com/users/timlind/followers",
    "following_url": "https://api.github.com/users/timlind/following{/other_user}",
    "gists_url": "https://api.github.com/users/timlind/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/timlind/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/timlind/subscriptions",
    "organizations_url": "https://api.github.com/users/timlind/orgs",
    "repos_url": "https://api.github.com/users/timlind/repos",
    "events_url": "https://api.github.com/users/timlind/events{/privacy}",
    "received_events_url": "https://api.github.com/users/timlind/received_events",
    "type": "User",
    "site_admin": false
  }
}
