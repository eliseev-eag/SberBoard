{
  "url": "https://api.github.com/repos/facebook/react/issues/16692",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16692/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16692/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16692/events",
  "html_url": "https://github.com/facebook/react/issues/16692",
  "id": 490554716,
  "node_id": "MDU6SXNzdWU0OTA1NTQ3MTY=",
  "number": 16692,
  "title": "Calling setState in the callback of setState prevents input's value to be updated by onChange ",
  "user": {
    "login": "adriendomoison",
    "id": 9092210,
    "node_id": "MDQ6VXNlcjkwOTIyMTA=",
    "avatar_url": "https://avatars0.githubusercontent.com/u/9092210?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adriendomoison",
    "html_url": "https://github.com/adriendomoison",
    "followers_url": "https://api.github.com/users/adriendomoison/followers",
    "following_url": "https://api.github.com/users/adriendomoison/following{/other_user}",
    "gists_url": "https://api.github.com/users/adriendomoison/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adriendomoison/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adriendomoison/subscriptions",
    "organizations_url": "https://api.github.com/users/adriendomoison/orgs",
    "repos_url": "https://api.github.com/users/adriendomoison/repos",
    "events_url": "https://api.github.com/users/adriendomoison/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adriendomoison/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-09-06T23:08:03Z",
  "updated_at": "2019-09-09T04:43:46Z",
  "closed_at": "2019-09-09T04:43:45Z",
  "author_association": "NONE",
  "body": "**I am reporting a *bug***\r\n\r\n\r\n**Current behavior:** Calling setState in the callback of setState to generate dynamic HTML containing inputs prevents input's `value=` to be updated by `onChange=`.\r\n\r\nConcretely, for a use case like this:\r\n```javascript\r\nrender() {\r\n    return (\r\n        <div>\r\n            <div>{this.state.inputs}</div>\r\n            // <button>Add one more input</button>\r\n        </div>\r\n    )\r\n}\r\n```\r\n\r\nThis doesn't work:\r\n```javascript\r\nvar apiData = [{ value: \"\" }, { value: \"\" }]\r\nthis.setState({\r\n    items: apiData,\r\n}, () => this.setState({\r\n    inputs: apiData.map((v, i) => {\r\n        return <input key={i} value={this.state.items[i].value}\r\n            onChange={(e) => this.handleChangeArray(e, i)} />\r\n    })\r\n}))\r\n```\r\n\r\nHere is a basic example that shows bug: https://jsfiddle.net/jw81uo4y/1/\r\n\r\nI opened a [question on stack overflow](https://stackoverflow.com/questions/57802807/calling-setstate-in-callback-of-setstate-generate-a-weird-bug-that-prevents-input) to check with the community first if I was not doing something silly.\r\n\r\n_I'm running react@16.9.0_\r\n\r\nThanks!\r\n",
  "closed_by": {
    "login": "adriendomoison",
    "id": 9092210,
    "node_id": "MDQ6VXNlcjkwOTIyMTA=",
    "avatar_url": "https://avatars0.githubusercontent.com/u/9092210?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adriendomoison",
    "html_url": "https://github.com/adriendomoison",
    "followers_url": "https://api.github.com/users/adriendomoison/followers",
    "following_url": "https://api.github.com/users/adriendomoison/following{/other_user}",
    "gists_url": "https://api.github.com/users/adriendomoison/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adriendomoison/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adriendomoison/subscriptions",
    "organizations_url": "https://api.github.com/users/adriendomoison/orgs",
    "repos_url": "https://api.github.com/users/adriendomoison/repos",
    "events_url": "https://api.github.com/users/adriendomoison/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adriendomoison/received_events",
    "type": "User",
    "site_admin": false
  }
}
