{
  "url": "https://api.github.com/repos/facebook/react/issues/459",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/459/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/459/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/459/events",
  "html_url": "https://github.com/facebook/react/pull/459",
  "id": 21924836,
  "node_id": "MDExOlB1bGxSZXF1ZXN0OTU4MDAyMg==",
  "number": 459,
  "title": "Improved whitespace collapsing rules",
  "user": {
    "login": "syranide",
    "id": 1714255,
    "node_id": "MDQ6VXNlcjE3MTQyNTU=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/1714255?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/syranide",
    "html_url": "https://github.com/syranide",
    "followers_url": "https://api.github.com/users/syranide/followers",
    "following_url": "https://api.github.com/users/syranide/following{/other_user}",
    "gists_url": "https://api.github.com/users/syranide/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/syranide/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/syranide/subscriptions",
    "organizations_url": "https://api.github.com/users/syranide/orgs",
    "repos_url": "https://api.github.com/users/syranide/repos",
    "events_url": "https://api.github.com/users/syranide/events{/privacy}",
    "received_events_url": "https://api.github.com/users/syranide/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2013-10-31T20:36:47Z",
  "updated_at": "2014-08-21T08:34:20Z",
  "closed_at": "2013-11-05T23:06:21Z",
  "author_association": "CONTRIBUTOR",
  "pull_request": {
    "url": "https://api.github.com/repos/facebook/react/pulls/459",
    "html_url": "https://github.com/facebook/react/pull/459",
    "diff_url": "https://github.com/facebook/react/pull/459.diff",
    "patch_url": "https://github.com/facebook/react/pull/459.patch"
  },
  "body": "I propose the following stricter and more well-defined rules for collapsing and removing whitespace, and have provided a patch to do it:\n1. Any whitespace sequence which CONTAIN A NEWLINE and TOUCHES the start or end of the string is removed completely `\\t ABC \\n` → `\\t ABC`\n2. Any whitespace sequence which CONTAIN A NEWLINE but DOES NOT TOUCH the start or end of the string is replaced with a single newline `ABC \\n DEF \\n` → `ABC\\nDEF \\n`\n\n_\\* The start and end of the string relates to `<tag>this plain text in the middle here{expr}`_\n#### Special-cases for whitespace between text literals\n\nRule 2, variation A: `A \\n B` → `A\\nB` (current)\n- Normally renders the same way as a space, but adds a lot of flexibility when intended (i.e, white-space: pre)\n- Non-whitespace dependent markdown can be written as-is (using Rule 3B it would be even more well-supported)\n- Space can be inserted instead using `A{' '}\\nB` → `A B`\n\nRule 2, variation B: `A \\n B` → `A B`\n- Perhaps slightly more intuitive result in final code (but when would this actually matter?)\n- Newline can be inserted instead using `A{'\\n'}\\nB` → `A\\nB`\n\nRule 3, variation A: `A \\t B` → `A B`\n- Overall consistent result in final code (minimal whitespace)\n- If additional whitespace is wanted, one must now explicit insert it `{' \\t '}`\n\nRule 3, variation B: `A \\t B` → `A \\t B` (current, so no rule 3)\n- The whitespace is _probably_ intentional, and if it isn't, it _normally_ renders the same way as if it was collapsed\n- Better support for inline markdown without braces\n- Now there's only two rules instead of three, and both are for newlines\n\nThere are a few possible variations of these as well, but they very rarely make sense. So overall I feel like the above rules are the most intuitive, consistent and quite flexible.\n\nI've switched to using Rule 3B instead (feel free to object), it doesn't make a difference for normal rendering, but allows almost all types of markdown to be written inline, it doesn't require being explicit like Rule 3A, but it is much more flexible when it comes to special inline text uses (white-space: pre, markdown, etc), with virtually no negatives.\n## Example:\n\n```\n<div>\n  <div>\n    Total: <span>2</span><br />\n    <span>Count: </span>3<br />\n    Amount:<span> </span>0<br />\n    <span>20</span>/\n    <span>30</span>\n  </div>\n  <div>\n    This {'the'} {'story'}.\n    That story.\n\n    Of the snow{' '}\n    white space.\n  </div>\n</div>\n```\n### What JSXTransformer produces:\n\nIn my opinion, a lot of unnecessary and unintentional whitespace is produced simply because the code is arranged into multiple lines for readability. This may sometimes produce unintentional \"padding\" in the resulting elements. `{'A'} {'B'}` does also not produce `A B` as one would expect.\n\n```\n\" Total: 2\"\n\"Count: 3\"\n\" Amount:0\"\n\"20/ 30\"\n\" This thestory. That story. Of the snow  white space. \"\n\nReact.DOM.div(null, \n  React.DOM.div(null, \n    \" Total: \", React.DOM.span(null, \"2\"),React.DOM.br(null ),\n    React.DOM.span(null, \"Count: \" ),\"3\",React.DOM.br(null ),\n    \" Amount:\",React.DOM.span(null ),\"0\",React.DOM.br(null ),\n    React.DOM.span(null, \"20\"),\"/ \",\n    React.DOM.span(null, \"30\")\n  ),\n  React.DOM.div(null, \n    \" This \", 'the', 'story',\". \"+\n    \"That story. \"+\n    \"Of the snow\",' ',\n    \" white space. \"\n  )\n)\n```\n### What my patch produces:\n\nIt produces whitespace according to well-defined and hopefully intuitive rules. It also mirrors the original code structure as closely as possible. **Note that `\\n` renders identically to space unless otherwise specified with CSS.**\n\n```\n\"Total: 2\"\n\"Count: 3\"\n\"Amount: 0\"\n\"20/30\"\n\"This the story.\\nThat story.\\nOf the snow white space.\"\n\nReact.DOM.div(null, \n  React.DOM.div(null, \n    \"Total: \", React.DOM.span(null, \"2\"),React.DOM.br(null ),\n    React.DOM.span(null, \"Count: \" ),\"3\",React.DOM.br(null ),\n    \"Amount:\",React.DOM.span(null, \" \" ),\"0\",React.DOM.br(null ),\n    React.DOM.span(null, \"20\"),\"/\",\n    React.DOM.span(null, \"30\")\n  ),\n  React.DOM.div(null, \n    \"This \", 'the',\" \", 'story',\".\\n\"+\n    \"That story.\\n\"+\n\n    \"Of the snow\",' ',\n    \"white space.\"\n  )\n)\n```\n",
  "closed_by": {
    "login": "jeffmo",
    "id": 498293,
    "node_id": "MDQ6VXNlcjQ5ODI5Mw==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/498293?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jeffmo",
    "html_url": "https://github.com/jeffmo",
    "followers_url": "https://api.github.com/users/jeffmo/followers",
    "following_url": "https://api.github.com/users/jeffmo/following{/other_user}",
    "gists_url": "https://api.github.com/users/jeffmo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jeffmo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jeffmo/subscriptions",
    "organizations_url": "https://api.github.com/users/jeffmo/orgs",
    "repos_url": "https://api.github.com/users/jeffmo/repos",
    "events_url": "https://api.github.com/users/jeffmo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jeffmo/received_events",
    "type": "User",
    "site_admin": false
  }
}
