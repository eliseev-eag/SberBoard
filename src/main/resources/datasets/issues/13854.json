{
  "url": "https://api.github.com/repos/facebook/react/issues/13854",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/13854/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/13854/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/13854/events",
  "html_url": "https://github.com/facebook/react/issues/13854",
  "id": 370127101,
  "node_id": "MDU6SXNzdWUzNzAxMjcxMDE=",
  "number": 13854,
  "title": "React.createContext with SSR leads to concurrency problems in environments with co-routines",
  "user": {
    "login": "macrozone",
    "id": 1972353,
    "node_id": "MDQ6VXNlcjE5NzIzNTM=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/1972353?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macrozone",
    "html_url": "https://github.com/macrozone",
    "followers_url": "https://api.github.com/users/macrozone/followers",
    "following_url": "https://api.github.com/users/macrozone/following{/other_user}",
    "gists_url": "https://api.github.com/users/macrozone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macrozone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macrozone/subscriptions",
    "organizations_url": "https://api.github.com/users/macrozone/orgs",
    "repos_url": "https://api.github.com/users/macrozone/repos",
    "events_url": "https://api.github.com/users/macrozone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macrozone/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2018-10-15T11:53:09Z",
  "updated_at": "2019-10-08T20:53:55Z",
  "closed_at": "2018-10-15T18:08:32Z",
  "author_association": "NONE",
  "body": "First some context: i am using react SSR with meteor. Meteor uses node-fibers (co-routines, see https://github.com/laverdet/node-fibers), which enables async code to run synchronously without async/await or generators. So i think that React.renderToString could be interrupted by other code and this leads to the problem, but i am totally unsure.\r\n\r\nGiven the following code:\r\n\r\n```\r\nconst MyContext = React.createContext();\r\n\r\nconst AppContent = () => (\r\n    <MyContext.Consumer>\r\n    {props => <SomeComponent {...props} />}\r\n    </MyContext.Consumer>\r\n)\r\nconst App = props => (\r\n    <MyContext.Provider value={props}>\r\n        <AppContent />\r\n    </MyContext.Provider>\r\n)\r\n```\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\nBug\r\n\r\n**What is the current behavior?**\r\n\r\nIf `<App />` gets rendered with different properties roughly at the same time, e.g.:\r\n\r\nexecution 1: `<App foo=\"execution1\" />`\r\n\r\nexecution 2: `<App foo=\"execution2\" />`\r\n\r\n\r\nthen `SomeComponent` might render twice with the same props (either twice execution1 or execution2\r\n\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\nSee above\r\n\r\n**What is the expected behavior?**\r\n\r\nContext consumer should only respect the current tree and pick up the value from the parent provider even in environments with fibers (co-routines)\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\n16.5.2\r\n",
  "closed_by": {
    "login": "aweary",
    "id": 6886061,
    "node_id": "MDQ6VXNlcjY4ODYwNjE=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6886061?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aweary",
    "html_url": "https://github.com/aweary",
    "followers_url": "https://api.github.com/users/aweary/followers",
    "following_url": "https://api.github.com/users/aweary/following{/other_user}",
    "gists_url": "https://api.github.com/users/aweary/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aweary/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aweary/subscriptions",
    "organizations_url": "https://api.github.com/users/aweary/orgs",
    "repos_url": "https://api.github.com/users/aweary/repos",
    "events_url": "https://api.github.com/users/aweary/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aweary/received_events",
    "type": "User",
    "site_admin": false
  }
}
