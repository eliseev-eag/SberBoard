{
  "url": "https://api.github.com/repos/facebook/react/issues/8693",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/8693/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/8693/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/8693/events",
  "html_url": "https://github.com/facebook/react/issues/8693",
  "id": 198901641,
  "node_id": "MDU6SXNzdWUxOTg5MDE2NDE=",
  "number": 8693,
  "title": "Native event.stopPropagation outside of React root cuts out React events",
  "user": {
    "login": "kenticomartinh",
    "id": 11004903,
    "node_id": "MDQ6VXNlcjExMDA0OTAz",
    "avatar_url": "https://avatars2.githubusercontent.com/u/11004903?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kenticomartinh",
    "html_url": "https://github.com/kenticomartinh",
    "followers_url": "https://api.github.com/users/kenticomartinh/followers",
    "following_url": "https://api.github.com/users/kenticomartinh/following{/other_user}",
    "gists_url": "https://api.github.com/users/kenticomartinh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kenticomartinh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kenticomartinh/subscriptions",
    "organizations_url": "https://api.github.com/users/kenticomartinh/orgs",
    "repos_url": "https://api.github.com/users/kenticomartinh/repos",
    "events_url": "https://api.github.com/users/kenticomartinh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kenticomartinh/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 40929153,
      "node_id": "MDU6TGFiZWw0MDkyOTE1Mw==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Enhancement",
      "name": "Type: Enhancement",
      "color": "84b6eb",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2017-01-05T08:34:37Z",
  "updated_at": "2017-10-04T16:15:20Z",
  "closed_at": "2017-10-04T16:15:19Z",
  "author_association": "NONE",
  "body": "We need to host a standalone React component (DraftJS editor) inside a HTML5 application which will run on other JS framework, or even plain JS or jQuery.\r\nThe code of the application is beyond our control, we are just a vendor of a component which adds some content, part of which is this React-based editor.\r\n\r\nAnyway, the most important part is that we need to add the component with the following code to an existing DIV.\r\n\r\n```\r\nconst editor = ReactDOM.render(\r\n    React.createElement(\r\n      EditorComponent,\r\n      props\r\n    ),\r\n    divElem\r\n  );\r\n```\r\n\r\nEditorComponent is a regular React component with some onClick events attached to its content (primarily toolbar buttons for the editor).\r\n\r\nI learned that React event model and its bubbling executes independently after the event bubbles all the way up to the document, and that if ev.stopPropagation() is called on native event, React events won't execute at all.\r\nThat is understandable for situations where document contains only the React app / component at its root and no other content, meaning you have control over all events on the page from React code.\r\n\r\nHowever, when React component is just a small fraction of the entire page, it may be severely influenced by the rest of the page.\r\nThe problem is that any event handling code above the component which calls ev.stopPropagation() cuts of the events of that smaller fraction, even that the event originated from the React component scope.\r\nThat influencing code could very well be just some jQuery plugin, so even author of the page may not be able to rewrite their code for some special event handling.\r\n\r\nHere is a fiddle to demonstrate that: [https://jsfiddle.net/martinh_kentico/kept9anh/3/](https://jsfiddle.net/martinh_kentico/kept9anh/3/)\r\n\r\nI believe that the point where the event chain breaks, allowing React to execute its events, should be the root element of React component, rather than the whole document.\r\nThis way, React root element could be considered an isolation edge of the React application / component.\r\n\r\n![reactevents](https://cloud.githubusercontent.com/assets/11004903/21673497/7d6a11b8-d329-11e6-9642-9d7427331fb1.png)\r\n\r\nI tracked the React event registration down to function ReactDOMComponent.ensureListeningTo(...) where I found the following code:\r\n\r\n```\r\n  var doc = isDocumentFragment ? containerInfo._node : containerInfo._ownerDocument;\r\n  listenTo(registrationName, doc);\r\n```\r\n  \r\nI tried to change `containerInfo._ownerDocument` to `containerInfo._node` to register the React event chain to the root of the React container, and tried it for several basic events (onClick, onMouseDown/Up) and it seems working for us as expected.\r\nReact events are not influenced by stopping propagation at the native events outside of React component root, so the two differently implemented parts of the application can coexist in peace.\r\n\r\nI am not sure why _ownerDocument was chosen over _node in the implementation and if changing it to _node could break something important.\r\n\r\nPlease advise if the proposed solution seems viable (in that case consider a change to that), or for what reasons you wouldn't recommend it.",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
