{
  "url": "https://api.github.com/repos/facebook/react/issues/10030",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/10030/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/10030/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/10030/events",
  "html_url": "https://github.com/facebook/react/issues/10030",
  "id": 238065502,
  "node_id": "MDU6SXNzdWUyMzgwNjU1MDI=",
  "number": 10030,
  "title": "ChangeEventPlugin.js IE detection is broken on Chrome/Safari/FF etc",
  "user": {
    "login": "alirussell",
    "id": 643153,
    "node_id": "MDQ6VXNlcjY0MzE1Mw==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/643153?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alirussell",
    "html_url": "https://github.com/alirussell",
    "followers_url": "https://api.github.com/users/alirussell/followers",
    "following_url": "https://api.github.com/users/alirussell/following{/other_user}",
    "gists_url": "https://api.github.com/users/alirussell/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alirussell/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alirussell/subscriptions",
    "organizations_url": "https://api.github.com/users/alirussell/orgs",
    "repos_url": "https://api.github.com/users/alirussell/repos",
    "events_url": "https://api.github.com/users/alirussell/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alirussell/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 178761159,
      "node_id": "MDU6TGFiZWwxNzg3NjExNTk=",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Regression",
      "name": "Type: Regression",
      "color": "e11d21",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2017-06-23T07:44:47Z",
  "updated_at": "2017-08-08T18:30:21Z",
  "closed_at": "2017-08-08T18:30:20Z",
  "author_association": "NONE",
  "body": "Bug\r\n\r\n**What is the current behavior?**\r\n\r\nOn our website we include a number of scripts from 3rd parties (Via segment etc) and one of them seems to be modifying `document.documentMode` inadvertently.  This in combination with the release of react-dom 15.6.0 has broken our website completely because of some code in ChangeEventPlugin.js. \r\n\r\nThe error `activeElement.detachEvent is not a function` is written in the console every time you try and click into an input box.\r\n\r\nIts specifically this line that is causing the issues: https://github.com/facebook/react/blob/v15.6.1/src/renderers/dom/client/eventPlugins/ChangeEventPlugin.js#L159\r\n\r\nThe 3rd party library is actually just setting `document.documentMode = undefined`, but this in itself is enough to break the line `'documentMode' in document` because even though `documentMode` is undefined, it now exists as a key in `document`.  This then means on all browsers react-dom believes its running in IE.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem via https://jsfiddle.net or similar (template: https://jsfiddle.net/84v837e9/).**\r\n\r\nTo reproduce on any app that uses react-dom 15.6.0/15.6.1 and includes input boxes, add the following at the top of the head tag (so it executes immediately):\r\n\r\n```\r\n<script>\r\ndocument.documentMode = undefined;\r\n</script>\r\n```\r\n\r\nAn example can be found here: https://codepen.io/anon/pen/gRxMGm\r\n\r\n**What is the expected behavior?**\r\n\r\nIn previous versions (And the 16.0 branch) of reactdom, the code is just `!document.documentMode` which works fine and will allow you to load relevant 3rd party libraries without experiencing any issues.\r\n\r\nWe have reached out to the vendor to fix the issue on their side, but I'm not sure how long this will take.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nDoesn't work in React Dom 15.6.0 and 15.6.1, but works in 15.5.4 and 16.0+\r\n\r\nFrom looking at the history of the code, it seems to have gone back and forth between the two different ways of checking documentMode, but this is the commit where it changed back to the code that causes an error: https://github.com/facebook/react/commit/68347c998571afa4fcce2fe7f4bab8cff6694980#diff-d7d43033e0c4300df2b535a9df27b8edR164\r\n",
  "closed_by": {
    "login": "aweary",
    "id": 6886061,
    "node_id": "MDQ6VXNlcjY4ODYwNjE=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6886061?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aweary",
    "html_url": "https://github.com/aweary",
    "followers_url": "https://api.github.com/users/aweary/followers",
    "following_url": "https://api.github.com/users/aweary/following{/other_user}",
    "gists_url": "https://api.github.com/users/aweary/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aweary/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aweary/subscriptions",
    "organizations_url": "https://api.github.com/users/aweary/orgs",
    "repos_url": "https://api.github.com/users/aweary/repos",
    "events_url": "https://api.github.com/users/aweary/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aweary/received_events",
    "type": "User",
    "site_admin": false
  }
}
