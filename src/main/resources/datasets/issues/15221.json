{
  "url": "https://api.github.com/repos/facebook/react/issues/15221",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/15221/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/15221/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/15221/events",
  "html_url": "https://github.com/facebook/react/issues/15221",
  "id": 425733192,
  "node_id": "MDU6SXNzdWU0MjU3MzMxOTI=",
  "number": 15221,
  "title": "Hook equivalent for `getSnapshotBeforeUpdate`",
  "user": {
    "login": "brainkim",
    "id": 2996754,
    "node_id": "MDQ6VXNlcjI5OTY3NTQ=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/2996754?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brainkim",
    "html_url": "https://github.com/brainkim",
    "followers_url": "https://api.github.com/users/brainkim/followers",
    "following_url": "https://api.github.com/users/brainkim/following{/other_user}",
    "gists_url": "https://api.github.com/users/brainkim/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brainkim/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brainkim/subscriptions",
    "organizations_url": "https://api.github.com/users/brainkim/orgs",
    "repos_url": "https://api.github.com/users/brainkim/repos",
    "events_url": "https://api.github.com/users/brainkim/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brainkim/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 121709921,
      "node_id": "MDU6TGFiZWwxMjE3MDk5MjE=",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Feature%20Request",
      "name": "Type: Feature Request",
      "color": "c7def8",
      "default": false
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2019-03-27T02:29:09Z",
  "updated_at": "2019-10-15T16:01:29Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\nFeature\r\n\r\n**What is the current behavior?**\r\n\r\nThere is no hook based equivalent for `getSnapshotBeforeUpdate`. The docs state:\r\n> Our goal is for Hooks to cover all use cases for classes as soon as possible. There are no Hook equivalents to the uncommon getSnapshotBeforeUpdate and componentDidCatch lifecycles yet, but we plan to add them soon.\r\n\r\n**What is the expected behavior?**\r\n\r\nThere is a hook based equivalent for `getSnapshotBeforeUpdate`, maybe something like:\r\n\r\n```js\r\nfunction ScrollingList(props) {\r\n  const lengthRef = React.useRef(0);\r\n  const listRef = React.useRef(null);\r\n\r\n  const prevHeight = React.useSnapshot(() => {\r\n    if (lengthRef.current < props.list.length) {\r\n      const list = listRef.current;\r\n      return list.scrollHeight - list.scrollTop;\r\n    }\r\n  }); \r\n\r\n  React.useEffect(() => {\r\n    lengthRef.current = props.list.length;\r\n  }, [props.list.length]);\r\n\r\n  React.useEffect(() => {\r\n    if (prevHeight != null) {\r\n      const list = listRef.current;\r\n      list.scrollTop = list.scrollHeight - prevHeight;\r\n    }\r\n  }, [prevHeight]);\r\n  return (\r\n    <div ref={listRef}>{/* ... */}</div>\r\n  );\r\n}\r\n```\r\n\r\nThis code probably is bug-ridden and not the best use of hooks but you get the idea.\r\n\r\nI’d like to know:\r\n1. If this feature is planned or on the roadmap.\r\n2. What the proposed API will be.\r\n3. If anyone is working on this.\r\n\r\nSorry, if this is being tracked somewhere and I haven’t seen it. I’m planning an intense component which will use `getSnapshotBeforeUpdate` and I’d love some guidance about the future of this lifecycle method.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nReact v16.8.0 and later. All browsers and OSes.\r\n\r\n",
  "closed_by": null
}
