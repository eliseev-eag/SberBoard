{
  "url": "https://api.github.com/repos/facebook/react/issues/12670",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12670/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12670/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12670/events",
  "html_url": "https://github.com/facebook/react/issues/12670",
  "id": 316864395,
  "node_id": "MDU6SXNzdWUzMTY4NjQzOTU=",
  "number": 12670,
  "title": "Improve warning message for failure to initialize `state` when using `getDerivedStateFromProps`",
  "user": {
    "login": "yourcelf",
    "id": 21318,
    "node_id": "MDQ6VXNlcjIxMzE4",
    "avatar_url": "https://avatars3.githubusercontent.com/u/21318?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yourcelf",
    "html_url": "https://github.com/yourcelf",
    "followers_url": "https://api.github.com/users/yourcelf/followers",
    "following_url": "https://api.github.com/users/yourcelf/following{/other_user}",
    "gists_url": "https://api.github.com/users/yourcelf/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yourcelf/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yourcelf/subscriptions",
    "organizations_url": "https://api.github.com/users/yourcelf/orgs",
    "repos_url": "https://api.github.com/users/yourcelf/repos",
    "events_url": "https://api.github.com/users/yourcelf/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yourcelf/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 40929153,
      "node_id": "MDU6TGFiZWw0MDkyOTE1Mw==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Enhancement",
      "name": "Type: Enhancement",
      "color": "84b6eb",
      "default": false
    },
    {
      "id": 717031390,
      "node_id": "MDU6TGFiZWw3MTcwMzEzOTA=",
      "url": "https://api.github.com/repos/facebook/react/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "6ce26a",
      "default": true
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2018-04-23T15:29:28Z",
  "updated_at": "2018-08-03T15:09:58Z",
  "closed_at": "2018-08-03T15:09:58Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\n\r\nbug\r\n\r\n**What is the current behavior?**\r\n\r\nThe warning for a failure to initialize state when using `getDerivedStateFromProps` is not as clear as it could be.\r\n\r\nThis component produces the warning:\r\n> MyComponent: Did not properly initialize state during construction. Expected state to be an object, but it was undefined.`\r\n\r\n```js\r\nclass MyComponent extends React.Component {\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    return null;\r\n  }\r\n  render() {\r\n    return <span>Foo</span>\r\n  }\r\n}\r\n```\r\n\r\nThe warning can be resolved by adding `state = {}` either in the class definition or the constructor, or by not using `getDerivedStateFromProps`.\r\n\r\nSee https://github.com/reactjs/reactjs.org/issues/796 for more detail on why this warning message can be counter-intuitive.\r\n\r\nSince the [warning is specific](https://github.com/facebook/react/blob/b548b3cd640dbd515f5d67dafc0216bb7ee0d796/packages/react-reconciler/src/ReactFiberClassComponent.js#L509-L510) to the use of `getDerivedStateFromProps` and not triggered by any other state or lifecycle methods, and state initialization isn't required for other state methods like `this.setState`, it would make sense to me to mention `getDerivedStateFromProps` explicitly in the warning.\r\n\r\nHere's a proposal for a new warning message:\r\n> MyComponent: Component state must be initialized when using getDerivedStateFromProps. Expected state to be an object, but it was undefined.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nReact >= 16.3.0\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
