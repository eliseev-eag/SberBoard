{
  "url": "https://api.github.com/repos/facebook/react/issues/14818",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14818/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14818/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14818/events",
  "html_url": "https://github.com/facebook/react/issues/14818",
  "id": 408805417,
  "node_id": "MDU6SXNzdWU0MDg4MDU0MTc=",
  "number": 14818,
  "title": "Losing state and dispatch when passed to provider, with Typescript",
  "user": {
    "login": "bauervision",
    "id": 10403928,
    "node_id": "MDQ6VXNlcjEwNDAzOTI4",
    "avatar_url": "https://avatars3.githubusercontent.com/u/10403928?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bauervision",
    "html_url": "https://github.com/bauervision",
    "followers_url": "https://api.github.com/users/bauervision/followers",
    "following_url": "https://api.github.com/users/bauervision/following{/other_user}",
    "gists_url": "https://api.github.com/users/bauervision/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bauervision/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bauervision/subscriptions",
    "organizations_url": "https://api.github.com/users/bauervision/orgs",
    "repos_url": "https://api.github.com/users/bauervision/repos",
    "events_url": "https://api.github.com/users/bauervision/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bauervision/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 620368407,
      "node_id": "MDU6TGFiZWw2MjAzNjg0MDc=",
      "url": "https://api.github.com/repos/facebook/react/labels/Resolution:%20Needs%20More%20Information",
      "name": "Resolution: Needs More Information",
      "color": "fffde7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2019-02-11T14:24:18Z",
  "updated_at": "2019-07-15T13:00:33Z",
  "closed_at": "2019-02-14T20:29:16Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nBug\r\n\r\n**What is the current behavior?**\r\nWhen passing initialState through useReducer, and attaching [state, dispatch] to value of the Provider, both objects come out missing on the other side when I try to access them. Note: I'm only adding in my Typescript as well so you can see the whole picture in case something stands out. This issue exists with or without TS.\r\n\r\nHere's how I'm setting it all up:\r\n\r\n```ts\r\nexport interface IState {\r\n  isAuth: boolean;\r\n  user: string;\r\n};\r\n\r\nexport const initialState: IState = {\r\n  isAuth: true,\r\n  user: \"Mike\"\r\n};\r\n\r\ntype ContextProps = {\r\n  isAuth: boolean;\r\n  user: string;\r\n};\r\n\r\nexport const AdminStore = React.createContext<ContextProps>(initialState);\r\n```\r\n\r\nNow the reducer setup\r\n\r\n```ts\r\ninterface ILogout {\r\n  type: \"LOGOUT\";\r\n  value: boolean;\r\n}\r\n\r\ninterface ILogin {\r\n  type: \"LOGIN\";\r\n  value: boolean;\r\n}\r\ntype Actions = ILogin | ILogout;\r\n\r\nexport const reducer = (state: IState, action: Actions) => {\r\n  switch (action.type) {\r\n    case \"LOGOUT\":\r\n      return { ...state, isAuth: false, user: \"No one\" };\r\n    case \"LOGIN\":\r\n      return { ...state, isAuth: true, user: \"Mike\" };\r\n  }\r\n};\r\n```\r\n\r\nNow set it all to the provider\r\n\r\n```ts\r\nexport function AdminStoreProvider(props: any) {\r\nconst [state, dispatch] = useReducer(reducer, initialState);\r\n// state.isAuth is avail here\r\n// state.user is avail here\r\nconst value = { state, dispatch };\r\n// value.state.isAuth is avail here\r\nreturn (\r\n    /* value does not contain state once applied to the value prop */\r\n    <AdminStore.Provider value={value}>{props.children} \r\n    </AdminStore.Provider>\r\n   );\r\n}\r\n```\r\nTherefore when I try to access them...\r\n\r\n```ts\r\nconst AuthApp = () => {\r\n/* Property 'state' does not exist on type ContextProps */\r\n  const { state, dispatch } = useContext(AdminStore);\r\n  return <App auth={state.isAuth} />;\r\n};\r\n```\r\n\r\nI've tried altering how I create the context object, and it doesn't seem to matter:\r\n\r\n```ts\r\nexport const AdminStore = React.createContext<ContextProps>(initialState);\r\n//or\r\nexport const AdminStore = React.createContext<ContextProps>();\r\n// or\r\nexport const AdminStore = React.createContext<ContextProps>( {} );\r\n```\r\n\r\nAll 3 result in the same loss of data when I pass it to the Provider\r\n\r\nI've also added state and dispatch to ContextProps which then results in those values not being present based on how I createContext(), plus I don't think I should have to add them to my interface.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\nThe easiest way to reproduce the error is to download this sandbox\r\nhttps://codesandbox.io/s/7jk69315l0\r\n\r\nYou can see that it works there, but not once you download it and run it locally. I tried to run it on two different machines, and I have the same error on both. It loses state and dispatch when passed through the provider.\r\n\r\n**What is the expected behavior?**\r\nhttps://codesandbox.io/s/7jk69315l0\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\n\r\nUsing Win 10, this wasn't avail in previous versions of React\r\n```\r\n\"react\": \"^16.8.1\",\r\n\"react-dom\": \"^16.8.1\",\r\n\"react-icons\": \"^3.3.0\",\r\n\"react-router-dom\": \"^4.3.1\",\r\n\"reactstrap\": \"^7.1.0\"\r\n```\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
