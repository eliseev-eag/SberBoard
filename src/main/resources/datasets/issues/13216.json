{
  "url": "https://api.github.com/repos/facebook/react/issues/13216",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/13216/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/13216/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/13216/events",
  "html_url": "https://github.com/facebook/react/pull/13216",
  "id": 341672942,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MjAxNzU1NjYz",
  "number": 13216,
  "title": "[WIP] [simple-cache-provider] Subscriptions",
  "user": {
    "login": "acdlite",
    "id": 3624098,
    "node_id": "MDQ6VXNlcjM2MjQwOTg=",
    "avatar_url": "https://avatars0.githubusercontent.com/u/3624098?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/acdlite",
    "html_url": "https://github.com/acdlite",
    "followers_url": "https://api.github.com/users/acdlite/followers",
    "following_url": "https://api.github.com/users/acdlite/following{/other_user}",
    "gists_url": "https://api.github.com/users/acdlite/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/acdlite/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/acdlite/subscriptions",
    "organizations_url": "https://api.github.com/users/acdlite/orgs",
    "repos_url": "https://api.github.com/users/acdlite/repos",
    "events_url": "https://api.github.com/users/acdlite/events{/privacy}",
    "received_events_url": "https://api.github.com/users/acdlite/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 196858374,
      "node_id": "MDU6TGFiZWwxOTY4NTgzNzQ=",
      "url": "https://api.github.com/repos/facebook/react/labels/CLA%20Signed",
      "name": "CLA Signed",
      "color": "e7e7e7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-07-16T20:46:19Z",
  "updated_at": "2018-08-07T02:37:35Z",
  "closed_at": "2018-08-07T02:37:35Z",
  "author_association": "MEMBER",
  "pull_request": {
    "url": "https://api.github.com/repos/facebook/react/pulls/13216",
    "html_url": "https://github.com/facebook/react/pull/13216",
    "diff_url": "https://github.com/facebook/react/pull/13216.diff",
    "patch_url": "https://github.com/facebook/react/pull/13216.patch"
  },
  "body": "## Depends on #13139\r\n\r\nAdds subscription support to simple-cache-provider. A subscription is created the first time a value is read from the cache, and disposed once we detect that all the consumers have unmounted.\r\n\r\nOn the initial mount, subscriptions are stored in a special map on the nearest provider (`_pendingChildSubscriptionsMap`). When the initial mount commits, the subscriptions are transferred from the pending set to the newly mounted provider.\r\n\r\nThe advantage of this approach over the one used by the create-subscription package (and most third-party libraries) is that the context API is used to ensure consistency: if multiple components read the same value from the cache, they will always receive the same value. Subscriptions are created **per key**, not **per component**.\r\n\r\nBecause consistency is guaranteed between components, it's ok if the tree is out of sync with the latest subscription value. We never have to revert back to sync mode. In other words, the React tree is eventually consistent with the subscription, but multiple components within a single React tree are always consistent with each other.\r\n\r\nTODO:\r\n- [ ] `cache.purge`\r\n- [ ] `cache.preload`\r\n- [ ] Use the `calculateChangedBits` API to optimize subscription updates\r\n- [ ] Use a separate context type per resource, instead of one shared context. (We may want to hold off on this until we have automatic injection of context providers.)\r\n- [ ] More tests\r\n\r\nFollow ups:\r\n- This library would really benefit from automatic injection of context providers.",
  "closed_by": {
    "login": "acdlite",
    "id": 3624098,
    "node_id": "MDQ6VXNlcjM2MjQwOTg=",
    "avatar_url": "https://avatars0.githubusercontent.com/u/3624098?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/acdlite",
    "html_url": "https://github.com/acdlite",
    "followers_url": "https://api.github.com/users/acdlite/followers",
    "following_url": "https://api.github.com/users/acdlite/following{/other_user}",
    "gists_url": "https://api.github.com/users/acdlite/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/acdlite/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/acdlite/subscriptions",
    "organizations_url": "https://api.github.com/users/acdlite/orgs",
    "repos_url": "https://api.github.com/users/acdlite/repos",
    "events_url": "https://api.github.com/users/acdlite/events{/privacy}",
    "received_events_url": "https://api.github.com/users/acdlite/received_events",
    "type": "User",
    "site_admin": false
  }
}
