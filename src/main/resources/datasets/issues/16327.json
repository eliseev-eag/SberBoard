{
  "url": "https://api.github.com/repos/facebook/react/issues/16327",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16327/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16327/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16327/events",
  "html_url": "https://github.com/facebook/react/issues/16327",
  "id": 478757176,
  "node_id": "MDU6SXNzdWU0Nzg3NTcxNzY=",
  "number": 16327,
  "title": "data-reactroot disappears using react-router-dom for SSR",
  "user": {
    "login": "BingjieGao",
    "id": 8609155,
    "node_id": "MDQ6VXNlcjg2MDkxNTU=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/8609155?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/BingjieGao",
    "html_url": "https://github.com/BingjieGao",
    "followers_url": "https://api.github.com/users/BingjieGao/followers",
    "following_url": "https://api.github.com/users/BingjieGao/following{/other_user}",
    "gists_url": "https://api.github.com/users/BingjieGao/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/BingjieGao/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/BingjieGao/subscriptions",
    "organizations_url": "https://api.github.com/users/BingjieGao/orgs",
    "repos_url": "https://api.github.com/users/BingjieGao/repos",
    "events_url": "https://api.github.com/users/BingjieGao/events{/privacy}",
    "received_events_url": "https://api.github.com/users/BingjieGao/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2019-08-09T01:45:47Z",
  "updated_at": "2019-08-09T02:07:21Z",
  "closed_at": null,
  "author_association": "NONE",
  "body": "\r\nI'm encountering a very strange behaviour which I was not expecting such bizarre issue when setting up a skeleton of react based SSR application. I'm wondering why this **[\"data-reactroot\"]** attribute just automatically vanished once **react-router-dom** is applied on. Here is an example I made that has minimum impact of external libraries.\r\n\r\n**Do you want to request a feature or report a bug?**\r\nBub, probably.\r\n\r\n**What is the expected behavior?**\r\nI'm sort of expecting attribute **[\"data-reactroot\"]** is appended automatically and consistently.\r\n\r\nHere is the codebase\r\nclient.js\r\n```\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport App from './App.js';\r\nimport Routes from \"./Routes\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\"\r\n\r\nconst RouteCtx = (\r\n  <Router>\r\n      <Routes />\r\n  </Router>\r\n)\r\nReactDOM.hydrate(\r\n  RouteCtx,\r\ndocument.getElementById('root'));\r\n\r\n```\r\nclient/Routes.js\r\n```\r\nimport React from \"react\";\r\nimport Home from \"./components/Home\";\r\nimport Title from \"./components/Title\";\r\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\r\n\r\n\r\nexport default () => {\r\n  return (\r\n    <div>\r\n      <Route exact path=\"/\" component={Home} />\r\n    </div>\r\n  );\r\n\r\n}\r\n\r\n```\r\n\r\nserver/route.js\r\n```\r\nimport React from \"react\";\r\nimport { StaticRouter } from \"react-router-dom\";\r\nimport Routes from \"../client/Routes\";\r\nimport { renderToString } from \"react-dom/server\";\r\nimport Home from \"../client/components/Home\"\r\n\r\nexport default (req) => {\r\n    const content = renderToString(\r\n      <StaticRouter location={req.path}>\r\n        <Routes />\r\n      </StaticRouter>\r\n    )\r\n\r\n    return `\r\n      <html>\r\n      <head></head>\r\n      <body>\r\n          <div id=\"root\">${content}</div>\r\n          <script src=\"bundle.js\"></script>\r\n      </body>\r\n      \r\n      </html>\r\n    `;\r\n}\r\n\r\n```\r\n_The final outcome on browser side for the generated DOM differentiated accordingly using different version of react:_\r\n\r\n**Current behaviour with react v16.8.x**\r\n```\r\n<html>\r\n  <head></head>\r\n      <body>\r\n          <div id=\"root\">\r\n            <div>\r\n              <div>\r\n                    <h1>Hello! This is shanghai Team</h1>\r\n             </div>\r\n            </div>\r\n           </div>\r\n       <script src=\"bundle.js\"></script>\r\n    </body>\r\n</html>\r\n```\r\n\r\n**Behaviour with react v16.0.0**\r\nWith the same code base, the generated DOM is:\r\n```\r\n<html>\r\n<head></head>\r\n <body>\r\n     <div id=\"root\">\r\n            <div data-reactroot=\"\">\r\n                <div>\r\n                    <h1>Hello! This is shanghai Team</h1>\r\n                </div>\r\n             </div>\r\n     </div>\r\n     <script src=\"bundle.js\"></script>\r\n  </body>\r\n</html>\r\n```\r\nWhich has the attribute **[\"data-reactroot\"]** clearly.\r\nNot sure if this is something should be expecting or should be something wrong.\r\n",
  "closed_by": null
}
