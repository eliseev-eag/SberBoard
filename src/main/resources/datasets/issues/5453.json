{
  "url": "https://api.github.com/repos/facebook/react/issues/5453",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/5453/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/5453/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/5453/events",
  "html_url": "https://github.com/facebook/react/issues/5453",
  "id": 116406278,
  "node_id": "MDU6SXNzdWUxMTY0MDYyNzg=",
  "number": 5453,
  "title": "TestUtil.renderIntoDocument issue with refs",
  "user": {
    "login": "ccorcos",
    "id": 1794527,
    "node_id": "MDQ6VXNlcjE3OTQ1Mjc=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/1794527?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ccorcos",
    "html_url": "https://github.com/ccorcos",
    "followers_url": "https://api.github.com/users/ccorcos/followers",
    "following_url": "https://api.github.com/users/ccorcos/following{/other_user}",
    "gists_url": "https://api.github.com/users/ccorcos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ccorcos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ccorcos/subscriptions",
    "organizations_url": "https://api.github.com/users/ccorcos/orgs",
    "repos_url": "https://api.github.com/users/ccorcos/repos",
    "events_url": "https://api.github.com/users/ccorcos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ccorcos/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 40929155,
      "node_id": "MDU6TGFiZWw0MDkyOTE1NQ==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Question",
      "name": "Type: Question",
      "color": "cc317c",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2015-11-11T19:38:13Z",
  "updated_at": "2015-11-11T20:17:29Z",
  "closed_at": "2015-11-11T20:16:33Z",
  "author_association": "NONE",
  "body": "I'm quite unsure where this error is coming from.\n\n```\nError: Invariant Violation: addComponentAsRefTo(...): Only a ReactOwner can have refs. You might be adding a ref to a component that was not created inside a component's `render` method, or you have multiple copies of React loaded (details: https://fb.me/react-refs-must-have-owner).\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:26176 <- node_modules/react/node_modules/fbjs/lib/invariant.js:46:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:19543 <- node_modules/react/lib/ReactOwner.js:68:0\n    at attachRef (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:20361 <- node_modules/react/lib/ReactRef.js:23:0)\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:20380 <- node_modules/react/lib/ReactRef.js:42:0\n    at attachRefs (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:20251 <- node_modules/react/lib/ReactReconciler.js:21:0)\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:8011 <- node_modules/react/lib/CallbackQueue.js:66:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:20159 <- node_modules/react/lib/ReactReconcileTransaction.js:81:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:23475 <- node_modules/react/lib/Transaction.js:203:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:23422 <- node_modules/react/lib/Transaction.js:150:0\n    at batchedMountComponentIntoNode (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:18151 <- node_modules/react/lib/ReactMount.js:283:0)\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:23409 <- node_modules/react/lib/Transaction.js:137:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:15712 <- node_modules/react/lib/ReactDefaultBatchingStrategy.js:62:0\n    at batchedUpdates (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:21476 <- node_modules/react/lib/ReactUpdates.js:95:0)\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:18345 <- node_modules/react/lib/ReactMount.js:477:0\n    at ReactMount__renderNewRootComponent (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:19637 <- node_modules/react/lib/ReactPerf.js:67:0)\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:18419 <- node_modules/react/lib/ReactMount.js:551:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:18439 <- node_modules/react/lib/ReactMount.js:571:0\n    at React_render (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:19637 <- node_modules/react/lib/ReactPerf.js:67:0)\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:20723 <- node_modules/react/lib/ReactTestUtils.js:77:0\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:33989 <- /Users/jankarlorodriguez-rivera/Projects/web-ux/user-portal/test/spec/ui/dollar-input.coffee:11:16\n    at /var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:33991 <- /Users/jankarlorodriguez-rivera/Projects/web-ux/user-portal/test/spec/ui/dollar-input.coffee:6:31\n    at newRequire (/var/folders/br/b9kks4y50qvfl_1cr22jj1_c0000gn/T/7fc1a283a49574bce1059aa1c5f740be.browserify:75 <- /Users/jankarlorodriguez-rivera/Projects/web-ux/node_modules/proxyquireify/lib/prelude.js:75:0)\n    at /Users/jankarlorodriguez-rivera/Projects/web-ux/user-portal/test/spec/ui/dollar-input.coffee:1\n```\n\nI'm using coffeescript because the other tests are written in coffeescript but (1) I tried it with JSX and the same error and (2) it should matter anyways.\n\nDo here's my component, and it has a ref:\n\n``` jsx\nReact.createClass({\n  displayName: 'DollarInput',\n  // ...\n  render: function() {\n    return (\n      <input\n        ref=\"input\"\n        onChange={this.onChange}\n        onKeyDown={this.onKeyDown}\n        onBlur={this.onBlur}\n        value={this.state.amount}\n        className={this.props.className}\n        id={this.props.id}\n        autoComplete=\"off\"/>\n    )\n  }\n});\n```\n\nAnd here's my test -- using jasmine, karma, and phantomjs.\n\n``` coffee\nTestUtils = require('react-addons-test-utils')\nDollarInput = React.createFactory(require('user-portal/src/scripts/ui/dollar-input'))\n\ndescribe \"React dollar input\", ->\n  dollarInput = TestUtils.renderIntoDocument(DollarInput())\n```\n\nAny ideas where that error comes from?\n\nSome trouble shooting:\n- It says maybe I may have two instances of react being loaded. Well, I'm using bower and adding the proper files in my karma configuration:\n\n``` js\nfiles: [\n  'bower_components/react/react.js',\n  'bower_components/react/react-dom.js',\n  // ...\n  'test/*.coffee'\n]\n```\n\nI don't believe `require('react-addons-test-utils')` includes another version of React. And I wouldnt imagine Karma is loading react more than once either...\n- I don't believe I'm adding a ref outside the component's render function either. But when I remove the ref, then I dont get this error -- but the component wont work properly...\n\n``` jsx\nReact.createClass({\n  displayName: 'DollarInput',\n  // ...\n  render: function() {\n    return (\n      <input\n        onChange={this.onChange}\n        onKeyDown={this.onKeyDown}\n        onBlur={this.onBlur}\n        value={this.state.amount}\n        className={this.props.className}\n        id={this.props.id}\n        autoComplete=\"off\"/>\n    )\n  }\n});\n```\n",
  "closed_by": {
    "login": "jimfb",
    "id": 9595985,
    "node_id": "MDQ6VXNlcjk1OTU5ODU=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/9595985?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jimfb",
    "html_url": "https://github.com/jimfb",
    "followers_url": "https://api.github.com/users/jimfb/followers",
    "following_url": "https://api.github.com/users/jimfb/following{/other_user}",
    "gists_url": "https://api.github.com/users/jimfb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jimfb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jimfb/subscriptions",
    "organizations_url": "https://api.github.com/users/jimfb/orgs",
    "repos_url": "https://api.github.com/users/jimfb/repos",
    "events_url": "https://api.github.com/users/jimfb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jimfb/received_events",
    "type": "User",
    "site_admin": false
  }
}
