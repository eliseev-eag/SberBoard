{
  "url": "https://api.github.com/repos/facebook/react/issues/4461",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/4461/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/4461/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/4461/events",
  "html_url": "https://github.com/facebook/react/issues/4461",
  "id": 96573894,
  "node_id": "MDU6SXNzdWU5NjU3Mzg5NA==",
  "number": 4461,
  "title": "calling setState on componentWillMount in Shallow Render results in TypeError: Cannot read property '_currentElement' of null",
  "user": {
    "login": "drabinowitz",
    "id": 7275304,
    "node_id": "MDQ6VXNlcjcyNzUzMDQ=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7275304?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/drabinowitz",
    "html_url": "https://github.com/drabinowitz",
    "followers_url": "https://api.github.com/users/drabinowitz/followers",
    "following_url": "https://api.github.com/users/drabinowitz/following{/other_user}",
    "gists_url": "https://api.github.com/users/drabinowitz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/drabinowitz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/drabinowitz/subscriptions",
    "organizations_url": "https://api.github.com/users/drabinowitz/orgs",
    "repos_url": "https://api.github.com/users/drabinowitz/repos",
    "events_url": "https://api.github.com/users/drabinowitz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/drabinowitz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 204945357,
      "node_id": "MDU6TGFiZWwyMDQ5NDUzNTc=",
      "url": "https://api.github.com/repos/facebook/react/labels/Component:%20Shallow%20Renderer",
      "name": "Component: Shallow Renderer",
      "color": "eb6420",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 21,
  "created_at": "2015-07-22T13:53:41Z",
  "updated_at": "2015-12-02T02:56:43Z",
  "closed_at": "2015-12-02T02:56:43Z",
  "author_association": "NONE",
  "body": "Calling `setState` on `componentWillMount` in a component being Shallow Rendered will result in the error `TypeError: Cannot read property '_currentElement' of null` being thrown. I set up a test case:\n\n``` javascript\nvar expect = require('chai').expect;                                             \n\ndescribe('testing state', function() {                                           \n\n  beforeEach(function() {                                                        \n    var Window = require('domino/lib/Window');                                   \n    var domino = require('domino');                                              \n\n    global.document || (global.document = domino.createDocument());              \n    global.window = new Window(global.document);                                 \n    global.navigator = global.window.navigator;                                  \n  });                                                                            \n\n  it('should handle having initial state', function() {                          \n    // this passes                                                               \n    var React = require('react');                                                \n    var ReactTestUtils = require('react/lib/ReactTestUtils');                    \n\n    var Sample = React.createClass({displayName: \"Sample\",                       \n      getInitialState: function() {                                              \n        return {                                                                 \n          groovy: 'doovy'                                                        \n        };                                                                       \n      },                                                                         \n\n      render: function() {                                                       \n        return React.createElement(\"div\", null, this.state.groovy);              \n      }                                                                          \n    });                                                                          \n\n    var renderer = ReactTestUtils.createRenderer();                              \n    renderer.render(React.createElement(Sample, null), this);                    \n    var result = renderer.getRenderOutput();                                     \n    expect(result.props.children).to.equal('doovy');                             \n  });                                                                            \n\n  it('should handling set state on componentWillMount', function() {             \n    // this fails                                                                \n    var React = require('react');                                                \n    var ReactTestUtils = require('react/lib/ReactTestUtils');                    \n\n    var Sample = React.createClass({displayName: \"Sample\",                       \n      componentWillMount: function() {                                           \n        return this.setState({                                                   \n          groovy: 'doovy'                                                        \n        });                                                                      \n      },                                                                         \n\n      render: function() {                                                       \n        return React.createElement(\"div\", null, this.state.groovy);              \n      }                                                                          \n    });                                                                          \n\n    var renderer = ReactTestUtils.createRenderer();                              \n    renderer.render(React.createElement(Sample, null), this);                    \n    var result = renderer.getRenderOutput();                                     \n    expect(result.props.children).to.equal('doovy');                             \n  });                                                                            \n});    \n```\n",
  "closed_by": {
    "login": "sophiebits",
    "id": 6820,
    "node_id": "MDQ6VXNlcjY4MjA=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6820?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sophiebits",
    "html_url": "https://github.com/sophiebits",
    "followers_url": "https://api.github.com/users/sophiebits/followers",
    "following_url": "https://api.github.com/users/sophiebits/following{/other_user}",
    "gists_url": "https://api.github.com/users/sophiebits/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sophiebits/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sophiebits/subscriptions",
    "organizations_url": "https://api.github.com/users/sophiebits/orgs",
    "repos_url": "https://api.github.com/users/sophiebits/repos",
    "events_url": "https://api.github.com/users/sophiebits/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sophiebits/received_events",
    "type": "User",
    "site_admin": false
  }
}
