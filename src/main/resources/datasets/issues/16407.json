{
  "url": "https://api.github.com/repos/facebook/react/issues/16407",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16407/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16407/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16407/events",
  "html_url": "https://github.com/facebook/react/pull/16407",
  "id": 481303899,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MzA3ODI5Mzc5",
  "number": 16407,
  "title": "Fix message loop behavior when host callback is cancelled",
  "user": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 196858374,
      "node_id": "MDU6TGFiZWwxOTY4NTgzNzQ=",
      "url": "https://api.github.com/repos/facebook/react/labels/CLA%20Signed",
      "name": "CLA Signed",
      "color": "e7e7e7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-08-15T19:34:24Z",
  "updated_at": "2019-08-19T20:20:22Z",
  "closed_at": "2019-08-19T20:20:22Z",
  "author_association": "MEMBER",
  "pull_request": {
    "url": "https://api.github.com/repos/facebook/react/pulls/16407",
    "html_url": "https://github.com/facebook/react/pull/16407",
    "diff_url": "https://github.com/facebook/react/pull/16407.diff",
    "patch_url": "https://github.com/facebook/react/pull/16407.patch"
  },
  "body": "# https://github.com/facebook/react/pull/16407/commits/c2a1a771c6323c1b8256c3ca7c2834bd2b40c3a7\r\n\r\nNew test.\r\n\r\nThis works on master but would have been broken by #16145.\r\nI verified the test fails on that branch.\r\n\r\n# https://github.com/facebook/react/pull/16407/commits/3b70481e54882848c4b3a7e9edc4591c84c52053\r\n\r\nThis is the fix. Again, it doesn't affect master because we don't use `cancelHostCallback` yet. But it fixes the previously added test when combined with #16145. The actual problem isn't related to #16145, we just didn't execute the code path that triggers the bad case until that PR.\r\n\r\nThe problem itself is that `cancelHostCallback` would clear out the callback. Then in the message loop we would see that it's `null`, and exit early. But we wouldn't schedule another one, so the loop would stop. However, the boolean itself would stay true, so next time we schedule something, we'd think the loop was still running. And fail to schedule it. The fix is to reset the boolean.\r\n\r\nThe rAF codepath handles this earlier â€” in `onAnimate`. But we don't have that entry point in the message loop implementation. So we forgot to do it.\r\n\r\n# 22a12878b6907bf84f430c5e057802dbe7d0ec50\r\n\r\nJust some more tests from #16271 since we're not doing it for now.",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
