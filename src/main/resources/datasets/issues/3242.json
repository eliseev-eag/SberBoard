{
  "url": "https://api.github.com/repos/facebook/react/issues/3242",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/3242/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/3242/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/3242/events",
  "html_url": "https://github.com/facebook/react/issues/3242",
  "id": 58623902,
  "node_id": "MDU6SXNzdWU1ODYyMzkwMg==",
  "number": 3242,
  "title": "Rework msg for: \"Danger: Expected markup to render 15 nodes, but rendered 10\" invariant",
  "user": {
    "login": "slorber",
    "id": 749374,
    "node_id": "MDQ6VXNlcjc0OTM3NA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/749374?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/slorber",
    "html_url": "https://github.com/slorber",
    "followers_url": "https://api.github.com/users/slorber/followers",
    "following_url": "https://api.github.com/users/slorber/following{/other_user}",
    "gists_url": "https://api.github.com/users/slorber/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/slorber/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/slorber/subscriptions",
    "organizations_url": "https://api.github.com/users/slorber/orgs",
    "repos_url": "https://api.github.com/users/slorber/repos",
    "events_url": "https://api.github.com/users/slorber/events{/privacy}",
    "received_events_url": "https://api.github.com/users/slorber/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2015-02-23T18:03:35Z",
  "updated_at": "2017-01-17T22:20:24Z",
  "closed_at": "2017-01-17T21:15:40Z",
  "author_association": "CONTRIBUTOR",
  "body": "Hi,\n\nThis invariant message does not give great insight of what is happening. \n@syranide helped me to find out that this might be related to malformed html content used in `dangerouslySetInnerHTML` and it actually was the case.\n\nI use an \"autolinker\" library that transform text links into html links, and it has a bug that produces malformed HTML content (see https://github.com/gregjacobs/Autolinker.js/issues/88)\nThis bug actually broke the whole UI for an user. \nAn unperformant workaround is to parse the string before passing it to React with something like `$(\"<div>\" + autolinkerOutput + \"</div>\")[0].innerHTML`\nIt seems to me quite common in frontend apps code to transform or shorten dynamic html content, and any bug in these libraries can seriously mess up with React.\n\nIn this case, `Danger.dangerouslyRenderMarkup` was called with a markupList of size 15. But during this call:\n\n``` javascript\nvar renderNodes = createNodesFromMarkup(\n        markupListByNodeName.join(''),\n        emptyFunction // Do nothing special with <script> tags.\n      );\n```\n\nOnly 10 elements were returned, because of one of the elements being malformed, because the parsing of the browser only produced 10 dom nodes when calling `node.innerHTML = markup;`\n\n---\n\nI don't really know what to do with this.\n\nMaybe it can be better documented that `dangerouslySetInnerHTML` can only be used with well-formed HTML, even if the browser can fix the markup.\n\nMaybe the invariant message could be more helpful for the user in this case and telling the user it could be due to `dangerouslySetInnerHTML` with malformed html.\n\nMaybe this case of malformed HTML could be handled by React itself, but I don't really know how it could be done without performance penalty.\n\nI tried do parse each single markup individually to have the same input/output number with the following code, but It fails later:\n\n``` javascript\n      if ( markupList.length !== renderNodes.length ) {\n        renderNodes = markupListByNodeName.map(function(singleMarkup) {\n          return createNodesFromMarkup(singleMarkup,emptyFunction);\n        }).reduce(function(a, b) {\n          return a.concat(b);\n        });\n        console.warn(\"potential malformed HTML!!!\",renderNodes);\n      }\n```\n",
  "closed_by": {
    "login": "sophiebits",
    "id": 6820,
    "node_id": "MDQ6VXNlcjY4MjA=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6820?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sophiebits",
    "html_url": "https://github.com/sophiebits",
    "followers_url": "https://api.github.com/users/sophiebits/followers",
    "following_url": "https://api.github.com/users/sophiebits/following{/other_user}",
    "gists_url": "https://api.github.com/users/sophiebits/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sophiebits/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sophiebits/subscriptions",
    "organizations_url": "https://api.github.com/users/sophiebits/orgs",
    "repos_url": "https://api.github.com/users/sophiebits/repos",
    "events_url": "https://api.github.com/users/sophiebits/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sophiebits/received_events",
    "type": "User",
    "site_admin": false
  }
}
