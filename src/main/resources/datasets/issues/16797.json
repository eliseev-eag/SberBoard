{
  "url": "https://api.github.com/repos/facebook/react/issues/16797",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16797/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16797/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16797/events",
  "html_url": "https://github.com/facebook/react/issues/16797",
  "id": 494249661,
  "node_id": "MDU6SXNzdWU0OTQyNDk2NjE=",
  "number": 16797,
  "title": "Read latest state value in event handler",
  "user": {
    "login": "giorgi-m",
    "id": 41240312,
    "node_id": "MDQ6VXNlcjQxMjQwMzEy",
    "avatar_url": "https://avatars2.githubusercontent.com/u/41240312?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/giorgi-m",
    "html_url": "https://github.com/giorgi-m",
    "followers_url": "https://api.github.com/users/giorgi-m/followers",
    "following_url": "https://api.github.com/users/giorgi-m/following{/other_user}",
    "gists_url": "https://api.github.com/users/giorgi-m/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/giorgi-m/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/giorgi-m/subscriptions",
    "organizations_url": "https://api.github.com/users/giorgi-m/orgs",
    "repos_url": "https://api.github.com/users/giorgi-m/repos",
    "events_url": "https://api.github.com/users/giorgi-m/events{/privacy}",
    "received_events_url": "https://api.github.com/users/giorgi-m/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 40929155,
      "node_id": "MDU6TGFiZWw0MDkyOTE1NQ==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Question",
      "name": "Type: Question",
      "color": "cc317c",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 17,
  "created_at": "2019-09-16T20:05:17Z",
  "updated_at": "2019-09-18T16:33:01Z",
  "closed_at": "2019-09-17T17:56:25Z",
  "author_association": "NONE",
  "body": "I have this question I could have asked on Stack overflow, but I think it is more suitable for people from react team or more experienced users. So I will give it a try to ask it here.\r\n\r\nImagine I have event handler below where I **want to read latest state value and do something with it (however, not do a new `setState`)**:\r\n\r\n    onClick(){\r\n    \r\n      let data = this.state.data;\r\n      API.makeRequest(\"URL\", data);\r\n    \r\n    }\r\n\r\n[Here][1] Dan Abramov says it is safe to read state in event handler (in the sense it will be up to date).\r\nHowever he says this applies to react 16.\r\n\r\nOtherwise he suggests to use functional `setState` to get current state.\r\n\r\nI have question: what if I want to read latest state value in event handler, however such that it works also in later react versions (17+, without hooks)? One option IMHO would be to use functional `setState`, but what if like in the beginning of question I said I don't want to `setState`, just read the state value - and do something with it like network request. So using functional `setState` wouldn't be right for me, as it would force me to update state, right? Or I could return empty object from functional `setState` (to avoid updating state) and put the network request code inside it, like this:\r\n\r\n \r\n\r\n    onClick(){\r\n        \r\n       this.setState(ps=>{ \r\n            // using this form only to read current state in event handler which works for 16 and onwards versions probably\r\n            // but this breaks purity of this function\r\n            API.makeRequest(\"URL\", ps.data);\r\n            return {};\r\n       })\r\n        \r\n    }\r\n\r\nbut then I would violate that the function passed to functional `setState` must be pure.\r\n\r\nIs there a solution to the question I asked?\r\n\r\n  [1]: https://stackoverflow.com/a/43440790/3963067",
  "closed_by": {
    "login": "bvaughn",
    "id": 29597,
    "node_id": "MDQ6VXNlcjI5NTk3",
    "avatar_url": "https://avatars0.githubusercontent.com/u/29597?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bvaughn",
    "html_url": "https://github.com/bvaughn",
    "followers_url": "https://api.github.com/users/bvaughn/followers",
    "following_url": "https://api.github.com/users/bvaughn/following{/other_user}",
    "gists_url": "https://api.github.com/users/bvaughn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bvaughn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bvaughn/subscriptions",
    "organizations_url": "https://api.github.com/users/bvaughn/orgs",
    "repos_url": "https://api.github.com/users/bvaughn/repos",
    "events_url": "https://api.github.com/users/bvaughn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bvaughn/received_events",
    "type": "User",
    "site_admin": false
  }
}
