{
  "url": "https://api.github.com/repos/facebook/react/issues/16905",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16905/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16905/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16905/events",
  "html_url": "https://github.com/facebook/react/issues/16905",
  "id": 498937562,
  "node_id": "MDU6SXNzdWU0OTg5Mzc1NjI=",
  "number": 16905,
  "title": "A note on function components default parameters",
  "user": {
    "login": "melloc01",
    "id": 4994258,
    "node_id": "MDQ6VXNlcjQ5OTQyNTg=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/4994258?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/melloc01",
    "html_url": "https://github.com/melloc01",
    "followers_url": "https://api.github.com/users/melloc01/followers",
    "following_url": "https://api.github.com/users/melloc01/following{/other_user}",
    "gists_url": "https://api.github.com/users/melloc01/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/melloc01/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/melloc01/subscriptions",
    "organizations_url": "https://api.github.com/users/melloc01/orgs",
    "repos_url": "https://api.github.com/users/melloc01/repos",
    "events_url": "https://api.github.com/users/melloc01/events{/privacy}",
    "received_events_url": "https://api.github.com/users/melloc01/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-09-26T14:51:44Z",
  "updated_at": "2019-09-29T22:05:12Z",
  "closed_at": "2019-09-26T15:50:47Z",
  "author_association": "NONE",
  "body": "When you define default parameters for a function component, the component will have brand new parameters on every render (function call) - in case they aren't defined.\r\nTurns out that by doing this way we are not actually defining `defaultProps` (as possibly wanted) but creating objects in every function call, causing an infinite loop if Hook dependency array relies on the default parameter.\r\n\r\nMaybe not a real issue here, but found that today and felt there should be a note about this somewhere in the docs.\r\n\r\n### Relevant code:\r\nSee: https://codesandbox.io/s/jest-test-mfz1z?fontsize=14\r\n\r\n```js\r\n\r\n// index.test.js:\r\nit(\"renders\", () => {\r\n  const container = render(<SimpleComponent />);\r\n\r\n  expect(1).toBe(1);\r\n});\r\n\r\n// SimpleComponent.js:\r\nimport React from \"react\";\r\n\r\nlet x;\r\nlet tries = 0;\r\n\r\n// a new array will be created in every render \r\nexport default function SimpleComponent({ openedList = [] }) {\r\n  const [opened, setOpened] = React.useState([]);\r\n\r\n  React.useEffect(() => {\r\n    console.warn({ x, openedList });\r\n    console.warn(\"equality = \", x === openedList); // always false\r\n    x = openedList;\r\n\r\n    tries = tries + 1;\r\n\r\n    if (tries > 100) throw new Error(\"This is an infinite loop\");\r\n\r\n    setOpened(openedList);\r\n  }, [openedList]);\r\n\r\n  return null;\r\n}\r\n\r\n```",
  "closed_by": {
    "login": "bvaughn",
    "id": 29597,
    "node_id": "MDQ6VXNlcjI5NTk3",
    "avatar_url": "https://avatars0.githubusercontent.com/u/29597?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bvaughn",
    "html_url": "https://github.com/bvaughn",
    "followers_url": "https://api.github.com/users/bvaughn/followers",
    "following_url": "https://api.github.com/users/bvaughn/following{/other_user}",
    "gists_url": "https://api.github.com/users/bvaughn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bvaughn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bvaughn/subscriptions",
    "organizations_url": "https://api.github.com/users/bvaughn/orgs",
    "repos_url": "https://api.github.com/users/bvaughn/repos",
    "events_url": "https://api.github.com/users/bvaughn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bvaughn/received_events",
    "type": "User",
    "site_admin": false
  }
}
