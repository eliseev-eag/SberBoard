{
  "url": "https://api.github.com/repos/facebook/react/issues/12940",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12940/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12940/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12940/events",
  "html_url": "https://github.com/facebook/react/issues/12940",
  "id": 327909462,
  "node_id": "MDU6SXNzdWUzMjc5MDk0NjI=",
  "number": 12940,
  "title": "React-router not matching regex params with minified react build",
  "user": {
    "login": "adewergifosse",
    "id": 36973426,
    "node_id": "MDQ6VXNlcjM2OTczNDI2",
    "avatar_url": "https://avatars3.githubusercontent.com/u/36973426?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adewergifosse",
    "html_url": "https://github.com/adewergifosse",
    "followers_url": "https://api.github.com/users/adewergifosse/followers",
    "following_url": "https://api.github.com/users/adewergifosse/following{/other_user}",
    "gists_url": "https://api.github.com/users/adewergifosse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adewergifosse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adewergifosse/subscriptions",
    "organizations_url": "https://api.github.com/users/adewergifosse/orgs",
    "repos_url": "https://api.github.com/users/adewergifosse/repos",
    "events_url": "https://api.github.com/users/adewergifosse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adewergifosse/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2018-05-30T21:40:52Z",
  "updated_at": "2018-05-30T22:22:28Z",
  "closed_at": "2018-05-30T22:22:28Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n*bug*\r\n\r\n**What is the current behavior?**\r\nI am using webpack to bundle my React application.\r\nThe routing works perfectly with the React dev package, but stops working with the production build\r\n\r\nRoute file\r\n```\r\nclass RootClass extends Component {\r\n  componentDidMount() {\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <HashRouter>\r\n        <div className=\"page container-fluid\">\r\n          <div id=\"main\" className=\"container body-content\">\r\n            <br />\r\n            <br />\r\n            <Switch>\r\n              <Route exact path=\"/\" component={Home} />\r\n              <Route exact path=\"/s3\" component={S3} />\r\n              <Route exact path=\"/s3/:region/:bucketName/:prefix(.*)?\" component={Bucket}  />\r\n              <Route exact path=\"/lambda\" component={Lambda} />\r\n              <Route exact path=\"/iam\" component={IAM}  />\r\n              <Route exact path=\"/login\" component={Login} />\r\n              <Route exact path=\"*\" component={Home} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </HashRouter>);\r\n  }\r\n}\r\n```\r\n\r\nWith the react dev build the url `http://localhost:28000/#/s3/ap-southeast-2/escalate.aetheris.co/assets` matches the path `/s3/:region/:bucketName/:prefix(.*)?` whereas with the production build, it matches only the glob matching `*` and redirect to the Home component.\r\nProd webpack:\r\n```\r\nconst path = require('path');\r\nconst webpack = require('webpack');\r\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\r\nconst ExtractTextPlugin = require('extract-text-webpack-plugin');\r\nconst autoprefixer = require('autoprefixer');\r\n\r\nconst staticSourcePath = path.join(__dirname, 'static');\r\nconst sourcePath = path.join(__dirname, 'client');\r\nconst buildPath = path.join(__dirname, 'public');\r\n\r\nmodule.exports = {\r\n  devtool: 'cheap-module-source-map',\r\n  entry: {\r\n    app: ['./client/app.jsx'],\r\n  },\r\n  output: {\r\n    path: buildPath,\r\n    filename: '[name].[hash].js',\r\n  },\r\n  resolve: {\r\n    extensions: ['.webpack-loader.js', '.web-loader.js', '.loader.js', '.js', '.jsx'],\r\n    modules: [\r\n      sourcePath,\r\n      path.resolve(__dirname, 'node_modules'),\r\n    ],\r\n  },\r\n  plugins: [\r\n    new webpack.DefinePlugin({\r\n      'process.env.NODE_ENV': JSON.stringify('production'),\r\n    }),\r\n    new webpack.optimize.UglifyJsPlugin(),\r\n    new webpack.LoaderOptionsPlugin({\r\n      options: {\r\n        postcss: [\r\n          autoprefixer({\r\n            browsers: [\r\n              'last 3 version',\r\n              'ie >= 10',\r\n            ],\r\n          }),\r\n        ],\r\n        context: staticSourcePath,\r\n      },\r\n    }),\r\n    new webpack.HashedModuleIdsPlugin(),\r\n    new HtmlWebpackPlugin({\r\n      template: path.join(__dirname, 'index.html'),\r\n      path: buildPath,\r\n      filename: 'index.html',\r\n      minify: {\r\n        collapseWhitespace: true,\r\n        collapseInlineTagWhitespace: true,\r\n        removeComments: true,\r\n        removeRedundantAttributes: true,\r\n      },\r\n    }),\r\n    new ExtractTextPlugin({\r\n      filename: '[name].[contenthash].css',\r\n      allChunks: true,\r\n    }),\r\n  ],\r\n  module: {\r\n    rules: [\r\n      {\r\n        test: /\\.json$/,\r\n        loaders: ['json-loader'],\r\n        exclude: /(node_modules|server)/,\r\n      },\r\n      {\r\n        test: /.jsx?$/,\r\n        loaders: ['babel-loader?plugins[]=transform-decorators-legacy,plugins[]=react-hot-loader/babel,plugins[]=emotion'],\r\n        exclude: /(node_modules|server)/,\r\n      },\r\n      {\r\n        test: /\\.scss$/,\r\n        exclude: /node_modules/,\r\n        use: ExtractTextPlugin.extract({\r\n          fallback: 'style-loader',\r\n          use: [\r\n            { loader: 'css-loader', options: { minimize: true } },\r\n            'postcss-loader',\r\n            'resolve-url-loader',\r\n            'sass-loader',\r\n          ],\r\n        }),\r\n      },\r\n      {\r\n        test: /\\.(eot?.+|svg?.+|ttf?.+|otf?.+|woff?.+|woff2?.+)$/,\r\n        use: 'file-loader?name=assets/[name]-[hash].[ext]',\r\n      },\r\n      {\r\n        test: /\\.(png|gif|jpg|svg)$/,\r\n        use: [\r\n          'url-loader?limit=20480&name=assets/[name]-[hash].[ext]',\r\n        ],\r\n        include: staticSourcePath,\r\n      },\r\n    ],\r\n  },\r\n};\r\n\r\n```\r\n\r\nDev webpack:\r\n```\r\nconst ExtractTextPlugin = require('extract-text-webpack-plugin');\r\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\r\nconst webpack = require('webpack');\r\nconst path = require('path');\r\n\r\nconst buildPath = path.join(__dirname, 'public');\r\n\r\nfunction getEntrySources(sources) {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    // sources.push('webpack-dev-server/client?http://partners.nyriad.com');\r\n    sources.push('webpack/hot/only-dev-server');\r\n  }\r\n\r\n  return sources;\r\n}\r\n\r\nmodule.exports = {\r\n  entry: {\r\n    app: getEntrySources([\r\n      './client/app.jsx',\r\n    ]),\r\n  },\r\n  devServer: {\r\n    historyApiFallback: true,\r\n    hot: true,\r\n    inline: true,\r\n    host: '0.0.0.0',\r\n    disableHostCheck: true,\r\n    port: 28000,\r\n  },\r\n  output: {\r\n    filename: 'public/[name].js',\r\n  },\r\n  resolve: {\r\n    extensions: ['.js', '.jsx'],\r\n  },\r\n  module: {\r\n    rules: [\r\n      {\r\n        test: /\\.json$/,\r\n        loaders: ['json-loader'],\r\n        exclude: /(node_modules|server)/,\r\n      },\r\n      {\r\n        test: /.jsx?$/,\r\n        loaders: ['babel-loader?plugins[]=transform-decorators-legacy,plugins[]=react-hot-loader/babel,plugins[]=emotion'],\r\n        exclude: /(node_modules|server)/,\r\n      },\r\n      {\r\n        test: /\\.scss$/,\r\n        loaders: ['style-loader', 'css-loader', 'resolve-url-loader', 'sass-loader'],\r\n        exclude: /(node_modules|server)/,\r\n      },\r\n      {\r\n        test: /\\.(eot?.+|svg?.+|ttf?.+|otf?.+|woff?.+|woff2?.+)$/,\r\n        exclude: /(node_modules|server)/,\r\n        loader: 'file-loader',\r\n        options: {\r\n          name: '[path][name].[ext]',\r\n        },\r\n      },\r\n    ],\r\n  },\r\n  devtool: 'source-map',\r\n  plugins: [\r\n    new webpack.LoaderOptionsPlugin({\r\n      debug: true,\r\n    }),\r\n    new HtmlWebpackPlugin({\r\n      template: path.join(__dirname, 'index.html'),\r\n      path: buildPath,\r\n      filename: 'index.html',\r\n      minify: {\r\n        collapseWhitespace: true,\r\n        collapseInlineTagWhitespace: true,\r\n        removeComments: true,\r\n        removeRedundantAttributes: true,\r\n      },\r\n    }),\r\n    new ExtractTextPlugin('public/style.css', {\r\n      allChunks: true,\r\n    }),\r\n  ],\r\n};\r\n```\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\n**What is the expected behavior?**\r\nRoute should match same way with prod react build than dev\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nReact 16.4.0\r\nReact-router 4.2.0\r\nChrome Version 65.0.3325.146 (Official Build) (64-bit)",
  "closed_by": {
    "login": "aweary",
    "id": 6886061,
    "node_id": "MDQ6VXNlcjY4ODYwNjE=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6886061?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aweary",
    "html_url": "https://github.com/aweary",
    "followers_url": "https://api.github.com/users/aweary/followers",
    "following_url": "https://api.github.com/users/aweary/following{/other_user}",
    "gists_url": "https://api.github.com/users/aweary/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aweary/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aweary/subscriptions",
    "organizations_url": "https://api.github.com/users/aweary/orgs",
    "repos_url": "https://api.github.com/users/aweary/repos",
    "events_url": "https://api.github.com/users/aweary/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aweary/received_events",
    "type": "User",
    "site_admin": false
  }
}
