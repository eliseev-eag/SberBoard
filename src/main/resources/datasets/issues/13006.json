{
  "url": "https://api.github.com/repos/facebook/react/issues/13006",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/13006/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/13006/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/13006/events",
  "html_url": "https://github.com/facebook/react/issues/13006",
  "id": 330896347,
  "node_id": "MDU6SXNzdWUzMzA4OTYzNDc=",
  "number": 13006,
  "title": "react-reconciler questions",
  "user": {
    "login": "shichongrui",
    "id": 4642727,
    "node_id": "MDQ6VXNlcjQ2NDI3Mjc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/4642727?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shichongrui",
    "html_url": "https://github.com/shichongrui",
    "followers_url": "https://api.github.com/users/shichongrui/followers",
    "following_url": "https://api.github.com/users/shichongrui/following{/other_user}",
    "gists_url": "https://api.github.com/users/shichongrui/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shichongrui/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shichongrui/subscriptions",
    "organizations_url": "https://api.github.com/users/shichongrui/orgs",
    "repos_url": "https://api.github.com/users/shichongrui/repos",
    "events_url": "https://api.github.com/users/shichongrui/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shichongrui/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2018-06-09T15:30:37Z",
  "updated_at": "2018-08-21T17:40:03Z",
  "closed_at": "2018-06-09T17:02:58Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nNo\r\n\r\nI'm trying to build a custom renderer for react using `react-reconciler`. Most of the documentation and examples I've been able to find support rendering to a target once, but not re-rendering. But this is what I've been able to discover and am looking for more info on.\r\n\r\n`prepareUpdate` allows you to generate a diff of the old props and new props. The examples I've found say this should return an array but I'm not sure what the items in this array should look like. So for now I'm just returning true from this method.\r\n\r\n`commitUpdate` is run after `prepareUpdate` with old and new props, after which I can call the instance to tell it to update itself based on those props. But most examples I've found do not rely on the `children` from props and rather rely on `children` to come through methods such as `appendChild`/`removeChild`. It appears that when `commitUpdate` is run, none of the various `*Child` methods are called leading the `newProps` in `commitUpdate` to not reflect the children that are being tracked inside of the class. In this case I'm curious if perhaps I'm missing a `*Child` method in my implementation that is necessary but I don't know exists.\r\n\r\n    appendChild(child) {\r\n      this.children.push(child)\r\n    }\r\n\r\n    commitUpdate (oldProps, newProps) {\r\n      // this.children != newProps.children\r\n    }\r\n\r\nI've also noticed that in order for `commitUpdate` to be called you must also pass in `supportsMutation`. Is this the correct property to get this working?\r\n\r\nIn some examples I see that projects also have a `mutation` object in their host config that includes essentially copies of the `*Child` and `commitUpdate` methods from the host config but when I try to do this in my renderer, those methods never seem to be called.\r\n\r\nI'm also curious what the correct paradigm for attaching the underlying instances to one another. Currently, each of my elements has a render method that will call the render method of all of it's children and then add those children as sub views to the instance. But in cases where children might change, if I called render again I would end up with duplicate children in the parent. I've seen some examples where the elements attach themselves to their parents, rather than rendering all children and attaching the children to itself, which seems like it would resolve this issue, but this brings up another question.\r\n\r\nFor a custom element, when is the correct time to add/remove children from the underlying instance? Most examples I've seen use `*Child` methods to keep track of the children internally and then have a method that renders all children and adds them as sub views. But there is a question in my mind as to whether or not the `*Child` methods are where I should be adding the children as subviews to the instance. For example, when an instance's `appendChild` method is called, that's when I should add the subview as a child to the element. When `removeChild` is called, that is when I should remove that subview from the instance. Rather than simply using these methods to keep track of children to then render them at some other time.\r\n\r\n    appendChild(child) {\r\n      this.view.addSubview(child)\r\n    }\r\n    removeChild(child) {\r\n      this.view.removeSubview(child)\r\n    }\r\n\r\nRather than\r\n\r\n    children = new Set()\r\n    appendChild(child) {\r\n      this.children.add(child)\r\n    }\r\n    removeChild(child) {\r\n      this.children.delete(child)\r\n    }\r\n    render() {\r\n      this.children.forEach(child => {\r\n        this.view.addSubview(this.child.render())\r\n      })\r\n      return this.view\r\n    }",
  "closed_by": {
    "login": "shichongrui",
    "id": 4642727,
    "node_id": "MDQ6VXNlcjQ2NDI3Mjc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/4642727?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shichongrui",
    "html_url": "https://github.com/shichongrui",
    "followers_url": "https://api.github.com/users/shichongrui/followers",
    "following_url": "https://api.github.com/users/shichongrui/following{/other_user}",
    "gists_url": "https://api.github.com/users/shichongrui/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shichongrui/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shichongrui/subscriptions",
    "organizations_url": "https://api.github.com/users/shichongrui/orgs",
    "repos_url": "https://api.github.com/users/shichongrui/repos",
    "events_url": "https://api.github.com/users/shichongrui/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shichongrui/received_events",
    "type": "User",
    "site_admin": false
  }
}
