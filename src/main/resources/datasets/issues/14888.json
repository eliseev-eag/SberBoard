{
  "url": "https://api.github.com/repos/facebook/react/issues/14888",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14888/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14888/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14888/events",
  "html_url": "https://github.com/facebook/react/issues/14888",
  "id": 411936602,
  "node_id": "MDU6SXNzdWU0MTE5MzY2MDI=",
  "number": 14888,
  "title": "Context subscribers block thread for long period after restoring tab to foreground",
  "user": {
    "login": "benwiley4000",
    "id": 13558253,
    "node_id": "MDQ6VXNlcjEzNTU4MjUz",
    "avatar_url": "https://avatars2.githubusercontent.com/u/13558253?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benwiley4000",
    "html_url": "https://github.com/benwiley4000",
    "followers_url": "https://api.github.com/users/benwiley4000/followers",
    "following_url": "https://api.github.com/users/benwiley4000/following{/other_user}",
    "gists_url": "https://api.github.com/users/benwiley4000/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benwiley4000/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benwiley4000/subscriptions",
    "organizations_url": "https://api.github.com/users/benwiley4000/orgs",
    "repos_url": "https://api.github.com/users/benwiley4000/repos",
    "events_url": "https://api.github.com/users/benwiley4000/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benwiley4000/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 620368407,
      "node_id": "MDU6TGFiZWw2MjAzNjg0MDc=",
      "url": "https://api.github.com/repos/facebook/react/labels/Resolution:%20Needs%20More%20Information",
      "name": "Resolution: Needs More Information",
      "color": "fffde7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-02-19T13:58:29Z",
  "updated_at": "2019-02-19T14:51:15Z",
  "closed_at": "2019-02-19T14:34:07Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n\r\nBug! (I would argue it's a bug)\r\n\r\n**What is the current behavior?**\r\n\r\nIf a Context receives many value updates while an app is running in a background browser tab (while a different tab is in the foreground), the subscribers will be inundated with a metric ton of updates when the tab resumes. This is because the context updates with `requestAnimationFrame` whose callback is deferred until the tab refocuses in the foreground.\r\n\r\nYou can see that in practice here: https://benwiley4000.github.io/cassette/styleguide/ (for future reference the commit is here for when the site contents have changed: https://github.com/benwiley4000/cassette/commit/d732a3579fd7888e1c9a99eb4dfe8cf7aa8fa00d)\r\n1. Begin playing media\r\n2. Open dev tools and begin recording a performance profile\r\n3. Open a new tab and ignore the other tab for awhile (15-30 seconds?)\r\n4. Go back and stop the performance profile. At the end you'll see a flurry of context updates fired thanks to a bunch of media currentTime setState calls while the tab was in the background. You'll also notice the app UI is frozen during this time.\r\n\r\n![screenshot from 2019-02-19 08-47-40](https://user-images.githubusercontent.com/13558253/53020007-08a4dd00-3424-11e9-8131-d41971cf899c.png)\r\n\r\n**What is the expected behavior?**\r\n\r\nI think it would be better if the Context waited to call `requestAnimationFrame` at all until the tab is no longer hidden, and only updated with the latest context value. This would avoid app crashes, which could easily happen if the app runs in the background for a long time.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nReact 16.6.1, no idea (doubt it)",
  "closed_by": {
    "login": "benwiley4000",
    "id": 13558253,
    "node_id": "MDQ6VXNlcjEzNTU4MjUz",
    "avatar_url": "https://avatars2.githubusercontent.com/u/13558253?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benwiley4000",
    "html_url": "https://github.com/benwiley4000",
    "followers_url": "https://api.github.com/users/benwiley4000/followers",
    "following_url": "https://api.github.com/users/benwiley4000/following{/other_user}",
    "gists_url": "https://api.github.com/users/benwiley4000/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benwiley4000/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benwiley4000/subscriptions",
    "organizations_url": "https://api.github.com/users/benwiley4000/orgs",
    "repos_url": "https://api.github.com/users/benwiley4000/repos",
    "events_url": "https://api.github.com/users/benwiley4000/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benwiley4000/received_events",
    "type": "User",
    "site_admin": false
  }
}
