{
  "url": "https://api.github.com/repos/facebook/react/issues/15332",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/15332/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/15332/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/15332/events",
  "html_url": "https://github.com/facebook/react/issues/15332",
  "id": 429582415,
  "node_id": "MDU6SXNzdWU0Mjk1ODI0MTU=",
  "number": 15332,
  "title": "react hooks: a few inconveniences",
  "user": {
    "login": "frontdog",
    "id": 13433074,
    "node_id": "MDQ6VXNlcjEzNDMzMDc0",
    "avatar_url": "https://avatars2.githubusercontent.com/u/13433074?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frontdog",
    "html_url": "https://github.com/frontdog",
    "followers_url": "https://api.github.com/users/frontdog/followers",
    "following_url": "https://api.github.com/users/frontdog/following{/other_user}",
    "gists_url": "https://api.github.com/users/frontdog/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frontdog/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frontdog/subscriptions",
    "organizations_url": "https://api.github.com/users/frontdog/orgs",
    "repos_url": "https://api.github.com/users/frontdog/repos",
    "events_url": "https://api.github.com/users/frontdog/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frontdog/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 40929155,
      "node_id": "MDU6TGFiZWw0MDkyOTE1NQ==",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Question",
      "name": "Type: Question",
      "color": "cc317c",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-04-05T04:53:16Z",
  "updated_at": "2019-04-12T22:14:13Z",
  "closed_at": "2019-04-12T22:14:13Z",
  "author_association": "NONE",
  "body": "1) When using useEffect, can not get latest state. \r\n\r\nFor example, I add a event listener in componentDidMount.\r\n```\r\nconst App = () => {\r\n    const [state1, setState1] = useState('state1');\r\n    const [state2, setState2] = useState('state2');\r\n    useEffect(() => {\r\n        function handler() {\r\n            // can't get the latest state1 and state2 because of the scope.\r\n        }\r\n        document.addEventListener('click', handler);\r\n        return () => document.removeEventListener('click', handler);\r\n    }, [])\r\n}\r\n```\r\nI have to change code into this:\r\n```\r\nconst App = () => {\r\n    const [state1, setState1] = useState('state1');\r\n    const [state2, setState2] = useState('state2');\r\n    useEffect(() => {\r\n        function handler() {\r\n            // for the reason of scope, can't get the latest state1 and state2.\r\n        }\r\n        document.addEventListener('click', handler);\r\n        return () => document.removeEventListener('click', handler);\r\n    }, [state1, state2])\r\n    ....\r\n}\r\n```\r\nproblem solved, but the effect executes again. (wasteful ???)\r\n\r\n2) functional props cause updating subComponent every time.\r\n\r\n```\r\nconst App = () => {\r\n    const [state, useState] = useState(0)\r\n\r\n    function handleChange() {\r\n      // do something\r\n    }\r\n    return (\r\n        <SubComponent  onChange={handleChange} />\r\n    );\r\n}\r\n```\r\nIn this case, SubComponent will update every time App rerender, because the onChange prop is Changed. If we need to use state or props in handleChange, we have nothing to do with it.(If we useCallback, see No.1, the lastest state issue).\r\n",
  "closed_by": {
    "login": "threepointone",
    "id": 18808,
    "node_id": "MDQ6VXNlcjE4ODA4",
    "avatar_url": "https://avatars2.githubusercontent.com/u/18808?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/threepointone",
    "html_url": "https://github.com/threepointone",
    "followers_url": "https://api.github.com/users/threepointone/followers",
    "following_url": "https://api.github.com/users/threepointone/following{/other_user}",
    "gists_url": "https://api.github.com/users/threepointone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/threepointone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/threepointone/subscriptions",
    "organizations_url": "https://api.github.com/users/threepointone/orgs",
    "repos_url": "https://api.github.com/users/threepointone/repos",
    "events_url": "https://api.github.com/users/threepointone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/threepointone/received_events",
    "type": "User",
    "site_admin": false
  }
}
