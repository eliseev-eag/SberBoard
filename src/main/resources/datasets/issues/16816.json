{
  "url": "https://api.github.com/repos/facebook/react/issues/16816",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/16816/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/16816/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/16816/events",
  "html_url": "https://github.com/facebook/react/issues/16816",
  "id": 494998933,
  "node_id": "MDU6SXNzdWU0OTQ5OTg5MzM=",
  "number": 16816,
  "title": "React remount hooks when using throw promise and suspence",
  "user": {
    "login": "hugo972",
    "id": 6366077,
    "node_id": "MDQ6VXNlcjYzNjYwNzc=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6366077?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hugo972",
    "html_url": "https://github.com/hugo972",
    "followers_url": "https://api.github.com/users/hugo972/followers",
    "following_url": "https://api.github.com/users/hugo972/following{/other_user}",
    "gists_url": "https://api.github.com/users/hugo972/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hugo972/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hugo972/subscriptions",
    "organizations_url": "https://api.github.com/users/hugo972/orgs",
    "repos_url": "https://api.github.com/users/hugo972/repos",
    "events_url": "https://api.github.com/users/hugo972/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hugo972/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2019-09-18T05:36:28Z",
  "updated_at": "2019-09-18T13:19:29Z",
  "closed_at": "2019-09-18T09:22:56Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?** \r\nNot sure if that is by design or a bug\r\n\r\n**What is the current behavior?**\r\n```\r\nfunction MyComponent() {\r\n    const [state, setState] = useState(() => { console.log(\"init\"); return \"some state\"; });\r\n    const promise = getOrFetch(\"/some/api\");\r\n    if (!promise.completed /* let imagine you can do this */) { console.log(\"waiting\"); throw promise; }\r\n    console.log('rendering');\r\n}\r\n```\r\nthe result in the console is:\r\ninit\r\nwaiting\r\ninit\r\nwaiting\r\ninit\r\nrendering\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n\r\n**What is the expected behavior?**\r\n\r\nI expect hooks mounting will happen once even when using throw promise and suspense. looking at the console logs you can see that each time we thrown to suspence the hooks are remounting. I expect the console log be like:\r\ninit\r\nwaiting\r\nwaiting\r\nwaiting\r\nrendering\r\n\r\n In order to achivie a hook like behavior I will need to implement it by myself using the __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED (and I would like to keep my job)\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nlatest, chrome, windows",
  "closed_by": {
    "login": "threepointone",
    "id": 18808,
    "node_id": "MDQ6VXNlcjE4ODA4",
    "avatar_url": "https://avatars2.githubusercontent.com/u/18808?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/threepointone",
    "html_url": "https://github.com/threepointone",
    "followers_url": "https://api.github.com/users/threepointone/followers",
    "following_url": "https://api.github.com/users/threepointone/following{/other_user}",
    "gists_url": "https://api.github.com/users/threepointone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/threepointone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/threepointone/subscriptions",
    "organizations_url": "https://api.github.com/users/threepointone/orgs",
    "repos_url": "https://api.github.com/users/threepointone/repos",
    "events_url": "https://api.github.com/users/threepointone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/threepointone/received_events",
    "type": "User",
    "site_admin": false
  }
}
