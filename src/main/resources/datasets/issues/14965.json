{
  "url": "https://api.github.com/repos/facebook/react/issues/14965",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/14965/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/14965/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/14965/events",
  "html_url": "https://github.com/facebook/react/issues/14965",
  "id": 414915238,
  "node_id": "MDU6SXNzdWU0MTQ5MTUyMzg=",
  "number": 14965,
  "title": "Cannot get the latest values of the state inside useEffect hook( first load only ).",
  "user": {
    "login": "gideonairex",
    "id": 6386061,
    "node_id": "MDQ6VXNlcjYzODYwNjE=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/6386061?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gideonairex",
    "html_url": "https://github.com/gideonairex",
    "followers_url": "https://api.github.com/users/gideonairex/followers",
    "following_url": "https://api.github.com/users/gideonairex/following{/other_user}",
    "gists_url": "https://api.github.com/users/gideonairex/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gideonairex/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gideonairex/subscriptions",
    "organizations_url": "https://api.github.com/users/gideonairex/orgs",
    "repos_url": "https://api.github.com/users/gideonairex/repos",
    "events_url": "https://api.github.com/users/gideonairex/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gideonairex/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 620368407,
      "node_id": "MDU6TGFiZWw2MjAzNjg0MDc=",
      "url": "https://api.github.com/repos/facebook/react/labels/Resolution:%20Needs%20More%20Information",
      "name": "Resolution: Needs More Information",
      "color": "fffde7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2019-02-27T02:30:41Z",
  "updated_at": "2019-03-21T18:07:25Z",
  "closed_at": "2019-03-21T18:07:18Z",
  "author_association": "NONE",
  "body": "<!--\r\n  Note: if the issue is about documentation or the website, please file it at:\r\n  https://github.com/reactjs/reactjs.org/issues/new\r\n-->\r\n\r\n**Do you want to request a *feature* or report a *bug*?**\r\n_BUG_\r\n\r\n**What is the current behavior?**\r\nCannot get the latest values of the state inside our useEffect function ( only on first load ). But can log the latest values of the state upon re-render.\r\n\r\n**If the current behavior is a bug, please provide the steps to reproduce and if possible a minimal demo of the problem. Your bug will get fixed much faster if we can run your code and it doesn't have dependencies other than React. Paste the link to your JSFiddle (https://jsfiddle.net/Luktwrdm/) or CodeSandbox (https://codesandbox.io/s/new) example below:**\r\n```\r\nconst {\r\n\t\tiframeWindow,\r\n\t\tiframeDocument,\r\n\t\tcomponent,\r\n\t\tnewMessageCount\r\n\t} = useContext(AppContext);\r\n\r\n\t/**\r\n\t * Information variables\r\n\t */\r\n\tconst [threadList, changeThreadList] = useState([]);\r\n\tconst [contactInfo, changeContactInfo] = useState({});\r\n\tconst [twilioNumbers, changeTwilioNumbers] = useState([]);\r\n\tconst [recipientOptions, changeRecientOptions] = useState([]);\r\n\r\n\t/**\r\n\t * Loading States\r\n\t */\r\n\tconst [searchLoading, changeSearchLoading] = useState(false);\r\n\tconst [sendingMessage, changeSendingMessage] = useState(false);\r\n\tconst [gettingList, changeGettingList] = useState(true);\r\n\r\n\t/**\r\n\t * Load more page start\r\n\t */\r\n\tconst [pageStart, changePageStart] = useState(1);\r\n\tconst [loadMoreCount, changeLoadMoreCount] = useState(0);\r\n\tconst [firstLoad, changeFirstLoad] = useState(true);\r\n\r\n\t/**\r\n\t * Message body content to be sent to the backend\r\n\t */\r\n\tconst messageBody = {\r\n\t\tconversation_id: useInput(),\r\n\t\tcontact_number_id: useInput([]),\r\n\t\tmessage: useInput(),\r\n\t\ttwilio_number_id: useInput(),\r\n\t\tsending: useState(false)\r\n\t};\r\n\r\n        .....\r\n\r\n        /**\r\n          * instantiate the Pusher\r\n         */\r\n        useEffect(() => {\r\n            getNewMessageEvent();\r\n            updateMessageStatusEvent();\r\n        }, [firstLoad]);\r\n        \r\n\r\n       ....\r\n\r\n       /**\r\n\t * updates the message status\r\n\t */\r\n\tfunction updateMessageStatusEvent() {\r\n\r\n\t\teventPusher.updatewMessageStatus(({ data: { id, status } }) => {\r\n\r\n                        /**\r\n\t\t\t *\r\n\t\t\t * PROBLEM here we cant get the value of the updated threadList its always empty\r\n\t\t\t *\r\n\t\t\t *\r\n                          */\r\n\t\t\tconsole.log('local thread list', threadList);\r\n\t\t\tlet message = find(threadList, ['id', id]);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tconsole.log(id, threadList);\r\n\t\t\t}, 100);\r\n\t\t\t// if (typeof message != 'undefined') {\r\n\t\t\t// \tmessage.status = status;\r\n\t\t\t// \tconsole.log(threadList);\r\n\t\t\t// }\r\n\t\t});\r\n\t}\r\n\r\n        ....\r\n       return (\r\n          .....\r\n       );\r\n```\r\n\r\n**What is the expected behavior?**\r\nExpecting that the latest values of the state will be accessible inside our first load useEffect. Expecting that the state Array will be a pass by reference. Assuming that it can be accessible.\r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nUsing **^16.8.0**. This is a hooks implementation.\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
