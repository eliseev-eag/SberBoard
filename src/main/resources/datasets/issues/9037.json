{
  "url": "https://api.github.com/repos/facebook/react/issues/9037",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/9037/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/9037/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/9037/events",
  "html_url": "https://github.com/facebook/react/issues/9037",
  "id": 209269117,
  "node_id": "MDU6SXNzdWUyMDkyNjkxMTc=",
  "number": 9037,
  "title": "Error: performUpdateIfNecessary: Unexpected batch number ... in react v15.4.2 and react-dom v15.4.",
  "user": {
    "login": "wking",
    "id": 209920,
    "node_id": "MDQ6VXNlcjIwOTkyMA==",
    "avatar_url": "https://avatars1.githubusercontent.com/u/209920?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wking",
    "html_url": "https://github.com/wking",
    "followers_url": "https://api.github.com/users/wking/followers",
    "following_url": "https://api.github.com/users/wking/following{/other_user}",
    "gists_url": "https://api.github.com/users/wking/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wking/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wking/subscriptions",
    "organizations_url": "https://api.github.com/users/wking/orgs",
    "repos_url": "https://api.github.com/users/wking/repos",
    "events_url": "https://api.github.com/users/wking/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wking/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2017-02-21T20:52:35Z",
  "updated_at": "2017-10-31T20:16:47Z",
  "closed_at": "2017-02-22T03:27:10Z",
  "author_association": "NONE",
  "body": "Spun off from #6895, which was [closed with a request for reproducible test-cases to be filed as separate issues][1].  The [test-case I'd filed there][2] (which failed on v15.4.1) is still failing on 15.4.2:\r\n\r\n```\r\n$ node --version\r\nv6.9.4\r\n$ npm --version\r\n3.10.10\r\n$ git clone git://github.com/wking/performUpdateIfNecessary-bug.git bug\r\n$ cd bug\r\n$ npm install\r\n$ npm install\r\nperformUpdateIfNecessary-bug@0.1.0 /tmp/bug\r\n├─┬ react@15.4.2\r\n│ ├─┬ fbjs@0.8.9\r\n│ │ ├── core-js@1.2.7\r\n│ │ ├─┬ isomorphic-fetch@2.2.1\r\n│ │ │ ├─┬ node-fetch@1.6.3\r\n│ │ │ │ ├─┬ encoding@0.1.12\r\n│ │ │ │ │ └── iconv-lite@0.4.15\r\n│ │ │ │ └── is-stream@1.1.0\r\n│ │ │ └── whatwg-fetch@2.0.2\r\n│ │ ├─┬ promise@7.1.1\r\n│ │ │ └── asap@2.0.5\r\n│ │ ├── setimmediate@1.0.5\r\n│ │ └── ua-parser-js@0.7.12\r\n│ ├─┬ loose-envify@1.3.1\r\n│ │ └── js-tokens@3.0.1\r\n│ └── object-assign@4.1.1\r\n├── react-dom@15.4.2\r\n└─┬ react-scripts@0.7.0\r\n  …\r\n$ npm test\r\n…a…\r\n…\r\n  console.error node_modules/fbjs/lib/warning.js:36\r\n    Warning: performUpdateIfNecessary: Unexpected batch number (current 2, pending 1)\r\n\r\n FAIL  src/Bug.test.js\r\n  ● does not duplicate requests for loaded nodes\r\n\r\n    duplicate call for 7\r\n      \r\n      at Bug.<anonymous> (src/Bug.js:16:17)\r\n      at ReactCompositeComponentWrapper._processPendingState (node_modules/react-dom/lib/ReactCompositeComponent.js:675:66)\r\n      at ReactCompositeComponentWrapper.updateComponent (node_modules/react-dom/lib/ReactCompositeComponent.js:618:26)\r\n      at ReactCompositeComponentWrapper.performUpdateIfNecessary (node_modules/react-dom/lib/ReactCompositeComponent.js:561:12)\r\n      at Object.performUpdateIfNecessary (node_modules/react-dom/lib/ReactReconciler.js:157:22)\r\n      at runBatchedUpdates (node_modules/react-dom/lib/ReactUpdates.js:150:21)\r\n      at ReactReconcileTransaction.perform (node_modules/react-dom/lib/Transaction.js:140:20)\r\n      at ReactUpdatesFlushTransaction.perform (node_modules/react-dom/lib/Transaction.js:140:20)\r\n      at ReactUpdatesFlushTransaction.perform (node_modules/react-dom/lib/ReactUpdates.js:89:32)\r\n      at Object.flushBatchedUpdates (node_modules/react-dom/lib/ReactUpdates.js:172:19)\r\n      at ReactDefaultBatchingStrategyTransaction.closeAll (node_modules/react-dom/lib/Transaction.js:206:25)\r\n      at ReactDefaultBatchingStrategyTransaction.perform (node_modules/react-dom/lib/Transaction.js:153:16)\r\n      at Object.batchedUpdates (node_modules/react-dom/lib/ReactDefaultBatchingStrategy.js:62:26)\r\n      at Object.batchedUpdates (node_modules/react-dom/lib/ReactUpdates.js:97:27)\r\n      at Object._renderNewRootComponent (node_modules/react-dom/lib/ReactMount.js:320:18)\r\n      at Object._renderSubtreeIntoContainer (node_modules/react-dom/lib/ReactMount.js:401:32)\r\n      at Object.render (node_modules/react-dom/lib/ReactMount.js:422:23)\r\n      at Object.<anonymous>.it (src/Bug.test.js:7:48)\r\n\r\n  ✕ does not duplicate requests for loaded nodes (3ms)\r\n…\r\n```\r\n\r\nThere are no [local `catch` calls][3] in my code:\r\n\r\n```\r\n$ git grep catch\r\n…no hits…\r\n```\r\n\r\nAnd really, there's not much code in the example at all :p.  There may be bugs and catches deeper in the stack, but the only direct dependencies are `react-scripts`, `react`, and `react-dom`, so it seems like an issue in a Facebook-maintained repository (or possibly one of their dependencies, in which case a Facebook-maintained dependency may need to be bumped).\r\n\r\n[1]: https://github.com/facebook/react/issues/6895#issuecomment-281405036\r\n[2]: https://github.com/facebook/react/issues/6895#issuecomment-262750248\r\n[3]: https://github.com/facebook/react/issues/7617#issuecomment-247710003\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
