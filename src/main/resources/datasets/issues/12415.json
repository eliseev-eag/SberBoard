{
  "url": "https://api.github.com/repos/facebook/react/issues/12415",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/12415/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/12415/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/12415/events",
  "html_url": "https://github.com/facebook/react/issues/12415",
  "id": 307272934,
  "node_id": "MDU6SXNzdWUzMDcyNzI5MzQ=",
  "number": 12415,
  "title": "dangerouslySetInnerHTML will wrap on SSR but not client and both are editing invalid HTML",
  "user": {
    "login": "TimoRuetten",
    "id": 7010059,
    "node_id": "MDQ6VXNlcjcwMTAwNTk=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7010059?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/TimoRuetten",
    "html_url": "https://github.com/TimoRuetten",
    "followers_url": "https://api.github.com/users/TimoRuetten/followers",
    "following_url": "https://api.github.com/users/TimoRuetten/following{/other_user}",
    "gists_url": "https://api.github.com/users/TimoRuetten/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/TimoRuetten/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/TimoRuetten/subscriptions",
    "organizations_url": "https://api.github.com/users/TimoRuetten/orgs",
    "repos_url": "https://api.github.com/users/TimoRuetten/repos",
    "events_url": "https://api.github.com/users/TimoRuetten/events{/privacy}",
    "received_events_url": "https://api.github.com/users/TimoRuetten/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 710332294,
      "node_id": "MDU6TGFiZWw3MTAzMzIyOTQ=",
      "url": "https://api.github.com/repos/facebook/react/labels/Component:%20Server%20Rendering",
      "name": "Component: Server Rendering",
      "color": "d4c5f9",
      "default": false
    },
    {
      "id": 588833528,
      "node_id": "MDU6TGFiZWw1ODg4MzM1Mjg=",
      "url": "https://api.github.com/repos/facebook/react/labels/Difficulty:%20medium",
      "name": "Difficulty: medium",
      "color": "fbca04",
      "default": false
    },
    {
      "id": 710722093,
      "node_id": "MDU6TGFiZWw3MTA3MjIwOTM=",
      "url": "https://api.github.com/repos/facebook/react/labels/Type:%20Needs%20Investigation",
      "name": "Type: Needs Investigation",
      "color": "fbca04",
      "default": false
    },
    {
      "id": 717031390,
      "node_id": "MDU6TGFiZWw3MTcwMzEzOTA=",
      "url": "https://api.github.com/repos/facebook/react/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "6ce26a",
      "default": true
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2018-03-21T14:39:36Z",
  "updated_at": "2019-04-12T12:45:06Z",
  "closed_at": "2018-08-06T15:25:39Z",
  "author_association": "NONE",
  "body": "Currently we need to use the dangerouslySetInnerHTML tag in a special case. In this case we need to split our string into several and then we need to render them. This could look like this:\r\n\r\n```javascript\r\n[\r\n      <div\r\n        key=\"markup-1\"\r\n        dangerouslySetInnerHTML={{ __html: '<div><h1>InnerHtml Test</h1>' }}\r\n      />,\r\n      <div\r\n        key=\"markup-2\"\r\n        dangerouslySetInnerHTML={{ __html: '</div>' }}\r\n      />\r\n    ]\r\n```\r\n\r\nThis looks dirty - and yes, it is - but in our case we need to do smth like this until we've found a better solution. The Problem is that the SSR does not match with the client. This is the error:\r\n\r\n\r\n```javascript\r\nWarning: Prop `dangerouslySetInnerHTML` did not match. Server: \"<div><h1>InnerHtml Test</h1></div><div></div>\" Client: \"<div><h1>InnerHtml Test</h1></div>\"\r\n```\r\n\r\n**Problem 1**\r\nIt seems that on SSR react is wrapping the dangerouslyInnerHtml - the client does not. In general its a problem that React is wrapping it and we are wondering if we could avoid this somehow. Because our first HTML part is not valid and will just be valid with the second part.\r\n\r\n**Problem 2**\r\nThe second Problem is that it seems that react is making the part valid. On Server and on Client react is closing the first part with the </div>.\r\n\r\n\r\nMaybe you are wondering why we are doing this. The Problem is that we load HTML data from a database and we need to replace some special words with real React Components. So our  plan was something like this:\r\n\r\n```html\r\n<div>\r\n<h1>Markup</h1>\r\n<p>Some text...</p>\r\n<RenderAComponentHere />\r\n<p>More text ..</p>\r\n</div>\r\n```\r\nNow we split the HTML so we will get an Array with 2 Items.\r\n\r\n```javascript\r\n[\r\n'\r\n     <div>\r\n     <h1>Markup</h1>\r\n     <p>Some text...</p>\r\n',\r\n'\r\n     <p>More text ..</p>\r\n    </div>\r\n'\r\n]\r\n```\r\n\r\nNow we want to render the first Part with dangerouslySetInnerHTML, then we will render our real React-Component and then again the last part with dangerouslySetInnerHTML.\r\n\r\n",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
