{
  "url": "https://api.github.com/repos/facebook/react/issues/11838",
  "repository_url": "https://api.github.com/repos/facebook/react",
  "labels_url": "https://api.github.com/repos/facebook/react/issues/11838/labels{/name}",
  "comments_url": "https://api.github.com/repos/facebook/react/issues/11838/comments",
  "events_url": "https://api.github.com/repos/facebook/react/issues/11838/events",
  "html_url": "https://github.com/facebook/react/issues/11838",
  "id": 281580116,
  "node_id": "MDU6SXNzdWUyODE1ODAxMTY=",
  "number": 11838,
  "title": "Hydration warning with code splitting and server side rendering",
  "user": {
    "login": "nitish24p",
    "id": 13037986,
    "node_id": "MDQ6VXNlcjEzMDM3OTg2",
    "avatar_url": "https://avatars0.githubusercontent.com/u/13037986?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nitish24p",
    "html_url": "https://github.com/nitish24p",
    "followers_url": "https://api.github.com/users/nitish24p/followers",
    "following_url": "https://api.github.com/users/nitish24p/following{/other_user}",
    "gists_url": "https://api.github.com/users/nitish24p/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nitish24p/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nitish24p/subscriptions",
    "organizations_url": "https://api.github.com/users/nitish24p/orgs",
    "repos_url": "https://api.github.com/users/nitish24p/repos",
    "events_url": "https://api.github.com/users/nitish24p/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nitish24p/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 620368407,
      "node_id": "MDU6TGFiZWw2MjAzNjg0MDc=",
      "url": "https://api.github.com/repos/facebook/react/labels/Resolution:%20Needs%20More%20Information",
      "name": "Resolution: Needs More Information",
      "color": "fffde7",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2017-12-13T00:02:21Z",
  "updated_at": "2019-04-23T20:03:49Z",
  "closed_at": "2018-01-06T01:17:11Z",
  "author_association": "NONE",
  "body": "**Do you want to request a *feature* or report a *bug*?**\r\nBug maybe?\r\n\r\n**What is the current behavior?**\r\nWhen Server side rendering is enabled on the server side along with code splitting on the client side the app throws a warning \r\n```\r\nvendors.741d122c240b5639589c.js:701 Warning: Did not expect server HTML to contain a <div> in <div>.\r\nprintWarning @ vendors.741d122c240b5639589c.js:701\r\nwarning @ vendors.741d122c240b5639589c.js:725\r\nwarnForDeletedHydratableElement @ vendors.741d122c240b5639589c.js:20946\r\ndidNotHydrateInstance @ vendors.741d122c240b5639589c.js:31362\r\ndeleteHydratableInstance @ vendors.741d122c240b5639589c.js:26084\r\npopHydrationState @ vendors.741d122c240b5639589c.js:26244\r\ncompleteWork @ vendors.741d122c240b5639589c.js:25232\r\ncompleteUnitOfWork @ vendors.741d122c240b5639589c.js:26807\r\nperformUnitOfWork @ vendors.741d122c240b5639589c.js:26906\r\nworkLoop @ vendors.741d122c240b5639589c.js:27008\r\ncallCallback @ vendors.741d122c240b5639589c.js:15625\r\ninvokeGuardedCallbackDev @ vendors.741d122c240b5639589c.js:15664\r\ninvokeGuardedCallback @ vendors.741d122c240b5639589c.js:15521\r\nperformWork @ vendors.741d122c240b5639589c.js:27126\r\nscheduleUpdateImpl @ vendors.741d122c240b5639589c.js:27511\r\nscheduleUpdate @ vendors.741d122c240b5639589c.js:27450\r\nscheduleTopLevelUpdate @ vendors.741d122c240b5639589c.js:27721\r\nupdateContainer @ vendors.741d122c240b5639589c.js:27751\r\n(anonymous) @ vendors.741d122c240b5639589c.js:31431\r\nunbatchedUpdates @ vendors.741d122c240b5639589c.js:27582\r\nrenderSubtreeIntoContainer @ vendors.741d122c240b5639589c.js:31430\r\nhydrate @ vendors.741d122c240b5639589c.js:31452\r\n48 @ bundle.741d122c240b5639589c.js:304\r\n__webpack_require__ @ manifest.741d122c240b5639589c.js:55\r\n47 @ bundle.741d122c240b5639589c.js:254\r\n__webpack_require__ @ manifest.741d122c240b5639589c.js:55\r\nwebpackJsonpCallback @ manifest.741d122c240b5639589c.js:26\r\n(anonymous) @ bundle.741d122c240b5639589c.js:1\r\n```\r\nWhen code splitting is disabled the warning goes away.\r\n\r\n\r\n**What is the expected behavior?**\r\nAn error message should not be shown\r\n\r\n**In my serverMarkUp.js**\r\n```javascript\r\n  const markup = ReactDOMServer.renderToString(\r\n    <StaticRouter location={request.url} context={context}>\r\n      <App />\r\n    </StaticRouter>\r\n  );\r\n\r\n```\r\n**In my App.js**\r\n\r\n```javascript\r\n\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport About from './pages/AboutPage';\r\nimport Homepage from './pages/Homepage';\r\nimport LearnMorePage from './pages/LearnMorePage';\r\n\r\nclass App extends Component<{}, {}> {\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Switch>\r\n          <Route exact path={RoutingConstants.HOME} component={Homepage} />\r\n          <Route path={RoutingConstants.LEARN_MORE} component={LearnMorePage} />\r\n          <Route path={RoutingConstants.ABOUT_US} component={AboutPage} />\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n```\r\n\r\nNow moving over to the Client side\r\n\r\n**My index.js**\r\n\r\n```javascript\r\n\r\nimport { hydrate } from 'react-dom';\r\nimport ClientApp from './clientApp';\r\nhydrate(\r\n  <BrowserRouter>\r\n    <ScrollHandler>\r\n      <ClientApp />\r\n    </ScrollHandler>\r\n  </BrowserRouter>,\r\n  document.getElementById('root')\r\n);\r\n\r\n```\r\n\r\nMy ClientApp.js\r\n\r\n```javascript\r\ntype AsyncComponentState = {\r\n  component: any\r\n};\r\n\r\nfunction asyncComponent(importComponent: Function) {\r\n  class AsyncComponent extends Component<{}, AsyncComponentState> {\r\n    constructor(props) {\r\n      super(props);\r\n\r\n      this.state = {\r\n        component: null\r\n      };\r\n    }\r\n\r\n    /*\r\n    * This issue is an open issue related to flow\r\n    * https://github.com/facebook/flow/issues/1803\r\n    */\r\n    async componentDidMount() {\r\n      const { default: component } = await importComponent();\r\n\r\n      this.setState({\r\n        component: component\r\n      });\r\n    }\r\n\r\n    render() {\r\n      const C = this.state.component;\r\n\r\n      return C ? <C {...this.props} /> : null;\r\n    }\r\n  }\r\n\r\n  return AsyncComponent;\r\n}\r\n\r\nconst About = asyncComponent(() => import('./pages/About'));\r\nconst Homepage = asyncComponent(() => import('./pages/Homepage'));\r\nconst LearnMorePage = asyncComponent(() => import('./pages/LearnMorePage'));\r\n\r\nclass ClientApp extends Component<{}, {}> {\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Switch>\r\n          <Route exact path={RoutingConstants.HOME} component={Homepage} />\r\n          <Route path={RoutingConstants.LEARN_MORE} component={LearnMorePage} />\r\n          <Route path={RoutingConstants.ABOUT} component={About} />\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ClientApp;\r\n```\r\n\r\nNow when i change my `index.js` to include `<App />` instead of  `<ClientApp />` (i.e disable code splitting i dont get any warning).\r\n\r\nAm i missing something here ? ðŸ¤” \r\n\r\n**Which versions of React, and which browser / OS are affected by this issue? Did this work in previous versions of React?**\r\nReact 16\r\n\r\nI found a similar qn [here](https://stackoverflow.com/questions/47093638/server-side-rendering-and-async-routing-blank-flash-on-client-side-with-react1) on stackoverflow. Unfortunately there was no reply :(",
  "closed_by": {
    "login": "gaearon",
    "id": 810438,
    "node_id": "MDQ6VXNlcjgxMDQzOA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/810438?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gaearon",
    "html_url": "https://github.com/gaearon",
    "followers_url": "https://api.github.com/users/gaearon/followers",
    "following_url": "https://api.github.com/users/gaearon/following{/other_user}",
    "gists_url": "https://api.github.com/users/gaearon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gaearon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gaearon/subscriptions",
    "organizations_url": "https://api.github.com/users/gaearon/orgs",
    "repos_url": "https://api.github.com/users/gaearon/repos",
    "events_url": "https://api.github.com/users/gaearon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gaearon/received_events",
    "type": "User",
    "site_admin": false
  }
}
